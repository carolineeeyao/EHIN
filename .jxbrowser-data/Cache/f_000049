/* Last Updated: 2016-02-16 11:42:34 -0500 */
/*
* 3Play Media Plugin, v3.0
* 3Play Media: Cambridge, MA, USA
* support@3playmedia.com
* Â©2016 3Play Media, Inc.  The following software is the sole and exclusive property of 3Play Media, Inc. and may not to be reproduced, modified, distributed or otherwise used, without the written approval of 3Play Media, Inc.  We have granted approval to our paying customers while they are our customers to reproduce, modify and use (but not distribute) this software for their own internal use only.  This means that if you are not a paying customer of 3Play Media, Inc., you may not reproduce, modify, distribute or otherwise use the code. 
* Paying customers who are permitted and do use this software are hereby advised that this software is provided "as is" and any express or implied warranties, including but not limited to, an implied warranty of merchantability and fitness for a particular purpose are disclaimed.  In no event shall 3Play Media, Inc. be liable for any direct, indirect, incidental, special, exemplary, or consequential damages (including but not limited to, procurement or substitute goods or services, loss of use, data or profits, or business interruption) however caused and on any theory of liability, whether in contract, strict liability, or tort (including negligence or otherwise) arising in any way out of the use of this software, even if advised of the possibility of such damage.
*/
function run_p3(){return!p3_window_loaded&&p3_window_wait||!p3_loader_complete?!1:p3_already_loaded?!1:(p3_already_loaded=!0,"undefined"!=typeof window.p3_async_before_init&&window.p3_async_before_init(),"undefined"!=typeof window.p3_async_init&&window.p3_async_init(),"undefined"!=typeof p3_instances&&"undefined"!=typeof p3_api_key&&P3.init(p3_instances,p3_api_key),void("undefined"!=typeof window.p3_async_after_init&&window.p3_async_after_init()))}function receiveOoyalaP3Event(t,e,i){switch(e){case"apiReady":p3_ooyala_initialized.push(t);break;case"playheadTimeChanged":var n=P3.find_instance_by_player_reference(t);n&&(n.player["interface"].playhead_time=parseInt(1e3*parseFloat(i.playheadTime)));break;case"stateChanged":P3.Log.log("Ooyala state change: "+i.state);break;case"currentItemEmbedCodeChanged":break;case"embedCodeChanged":var a=i.embedCode,n=P3.find_instance_by_player_reference(a);n.player_reference=t,p3_ooyala_interfaces[t]=n.player["interface"],P3.Log.info("Ooyala Current Embed Code Changed");break;case"totalTimeChanged":var n=P3.find_instance_by_player_reference(t);n&&(n.player["interface"].total_time=parseInt(1e3*parseFloat(i.totalTime)))}}function html5_kaltura_play_handler(){P3.get(0).player["interface"].player_state="PLAYING"}function html5_kaltura_pause_handler(){P3.get(0).player["interface"].player_state="PAUSED"}function html5_kaltura_update_playhead(t){P3.get(0).player["interface"].player_state="PLAYING",P3.get(0).player["interface"].playhead_time=1e3*parseFloat(t)}function p3_listen(t,e,i){P3.JQuery(P3.get(t)).bind(e,i)}var P3={instances:[],init:function(t,e){if(!P3.is_compatible())return!1;P3.Settings.api_key=P3.Settings.api_key||e;var n=P3.instances.length,a=!1;for(i in t)t[i].debugger_ui&&(a=!0),P3.instances.push(new P3.create_instance(i,t[i],n)),n++;a&&(P3.debugger_ui=new P3.DebuggerUI)},is_compatible:function(){return!0},browser_invalid:function(){switch(!0){case P3.JQuery.browser.msie&&parseFloat(P3.JQuery.browser.version)<6:return!0}return!1},create_instance:function(t,e,i){if(this.instance_index=i,this.settings=e,"simple"==e.api_version&&e.project_id&&(P3.Settings.api_host=P3.Settings.api_host.replace(/\.com.*$/,".com")+"/p/projects/"+e.project_id,P3.Settings.static_host=P3.Settings.static_host.replace(/\.com.*$/,".com")+"/p/projects/"+e.project_id),this.player_reference=t,this.player=new P3.Player(this,t,e),this.event=new P3.Event(this),this.settings.transcript&&this.settings.transcript.target&&(this.transcript=new P3.Transcript(this,e)),this.settings.playlist&&this.settings.playlist.target&&(this.playlist=new P3.Playlist(this,e)),this.settings.captions&&(this.captions=new P3.Captions(this,e)),this.settings.collection&&this.settings.collection.target){var n=this.instance_index;P3.Util.load_remote_script(P3.Settings.p3_host+"/javascripts/P3.Collection.js",function(){P3.get(n).collection=new P3.Collection(P3.get(n),P3.get(n).settings)})}if(this.settings.video_search&&this.settings.video_search.target){var n=this.instance_index;P3.Util.load_remote_script(P3.Settings.p3_host+"/javascripts/P3.VideoSearch.js",function(){P3.get(n).video_search=new P3.VideoSearch(P3.get(n),P3.get(n).settings)})}if(p3_extensions&&p3_extensions.length>0)for(var a=0;a<p3_extensions.length;a++){var r=p3_extensions[a].split("/").slice(-1)[0].replace(/\..*$/,"").replace(/\-/g,"_"),s=P3.Util.to_camel_case(r);this.settings[r]&&(this[r]=new P3[s](this,e))}},clear_instance:function(t){if("number"==typeof t)var e=P3.instances[t];else if("string"==typeof t)var e=P3.find_instance_by_player_reference(t);return e?(e.player.stop_tracking(),e.transcript&&e.transcript.die(),e.captions&&e.captions.die(),e.transcript=e.captions=null,P3.instances.splice(t,1),void P3.index_instances()):(P3.Log.error("Could not find instance to clear: "+t),!1)},index_instances:function(){for(var t=0;t<P3.instances.length;t++)P3.instances[t].instance_index=t},find_instances_by_file_id:function(t){var e=[];return P3.JQuery.each(P3.instances,function(i){return P3.instances[i].settings.file_id==t?(e.push(P3.instances[i]),!1):void 0}),e},find_instances_by_video_id:function(t){var e=[];return P3.JQuery.each(P3.instances,function(i){return P3.instances[i].settings.platform_integration&&P3.instances[i].settings.file_id==t?(e.push(P3.instances[i]),!1):void 0}),e},find_instance_by_player_reference:function(t){var e=!1;return P3.JQuery.each(P3.instances,function(i){return P3.instances[i].player_reference==t?(e=P3.instances[i],!1):void 0}),e},get:function(t){return"number"==typeof t?this.instances[t]?this.instances[t]:!1:this.find_instance_by_player_reference(t)}};P3.About={supported_players:{brightcove:"Brightcove",delve:"Delve / Limelight",flowplayer:"Flowplayer",jw:"JW Player",kaltura:"Kaltura",ooyala:"Ooyala",vimeo:"Vimeo",vimeo_iframe:"Vimeo IFRAME",wistia:"Wistia",wistia_iframe:"Wistia IFRAME",youtube:"YouTube",soundmanager2:"SoundManager 2",html5:"HTML5",video_js:"Video.js"},plugins:{transcript:{label:"Interactive Transcript",support_doc:"http://support.3playmedia.com/forums/20752837-Interactive-Transcript"},captions:{label:"Captions",support_doc:"http://support.3playmedia.com/forums/20884686-Captions-Plugin"}},hosted_extensions:{captions_style:{label:"Captions Style",support_doc:!1}}},P3.Util={basename:function(t){return t.split(/[\/\\]/).slice(-1)},ms_to_stamp:function(t){var e=parseInt(t)/1e3,i=parseInt(e/60);return e%=60,e=10>e?"0"+e:e,(i+":"+e).replace(/\.\d*$/,"")},stamp_to_ms:function(t){t=t.replace(/\,/g,".");var e=t.split(/\:/),i=parseFloat(e[e.length-1]),n=parseInt(e[e.length-2],10),a=e.length>2?parseInt(e[e.length-3],10):0;return 1e3*(3600*a+60*n+i)},player_type:function(t){var e=P3.JQuery("#"+t);e.length<1&&(e=P3.JQuery("[name="+t+"]"));var i=(P3.JQuery(e).attr("name"),P3.JQuery(e).attr("class")),n=P3.JQuery(e).attr("src"),t=P3.JQuery(e).attr("id"),a=P3.JQuery(e).get(0).tagName.toLowerCase();if("iframe"==a)switch(!0){case/vimeo/i.test(i)||/vimeo/i.test(t)||/vimeo/i.test(n):return"vimeo_iframe";case/wistia/i.test(i)||/wistia/i.test(t):return"wistia_iframe"}else switch(!0){case"undefined"!=typeof e.get(0).addModelListener&&"undefined"!=e.get(0).sendEvent:return"jw";case/(player\d*?\.swf|jw)/.test(n):return"jw";case/kaltura/i.test(n)||/kaltura/i.test(t)||/kalturai/.test(i):return"kaltura";case/brightcove/i.test(i)||/brightcove/i.test(t):return"brightcove";case/wistia/i.test(i)||/wistia/i.test(t):return"wistia";case/youtube/i.test(n):return"youtube"}},params:function(t){var e=location.href.split("#");if(e.length<2)return!1;var n=e.slice(-1)[0].split("&"),a={};for(i=0;i<n.length;i++)e=n[i].split(":"),a[e[0]]=e[1];return t?a[t]||!1:a},in_array:function(t,e){for(var i=e.length,n=0;i>n;n++)if(e[n]==t)return!0;return!1},to_camel_case:function(t){return t=t.replace(/^\s+|\s+$/,""),t=t.replace(/[\-\_]([a-z])/g,function(t,e){return e.toUpperCase()}),t.charAt(0).toUpperCase()+t.slice(1)},truncate:function(t,e,i){return t.length>i-3?t.slice(0,i)+"..":t},tooltip:function(t,e,i,n){if(P3.Util.is_ipad())return!1;i=i||!1;var a=P3.JQuery("<div></div>");if(P3.JQuery(".p3-tooltip").fadeOut("fast",function(){P3.JQuery(this).remove()}),P3.JQuery(a).addClass("p3-tooltip"),i&&P3.JQuery(a).addClass(i),P3.JQuery(a).css({position:"absolute",zIndex:9999999999,top:Math.max(0,t.pageY+10),left:t.pageX+10}),P3.JQuery(a).html(e),P3.JQuery(document.body).append(a),P3.JQuery(t.target).mouseout(function(){setTimeout(function(){P3.JQuery(a).remove()},50)}),n){var r=$(t.target).parents(n+":first"),s=$(r).offset().left+$(r).outerWidth()-$(a).outerWidth();P3.JQuery(a).css("left",Math.min(t.pageX+10,s))}},load_remote_script:function(t,e){var i=document.createElement("script");if(i.src=t,i.type="text/javascript",e){i.onload=i.onreadystatechange=function(){return"undefined"!=typeof i.readyState&&"complete"!=i.readyState&&"loaded"!=i.readyState?!1:void e()};var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(i,n)}else P3.JQuery("script").get(0).parentNode.appendChild(i)},alert:function(t){P3.Log.error(t)},print:function(t,e){var i="toolbar=yes,location=no,directories=yes,menubar=yes,";i+="scrollbars=yes,width=750, height=600, left=100, top=25";var n=window.open("","",i);return n.document.open(),n.document.write("<html><head><title>Print Preview</title></head>"),n.document.write('<body style="padding:4px;">'),n.document.write("<p>"),n.document.write('<input type="button" onclick=javascript:window.print(); value="Print This Document"/>'),n.document.write("</p><hr/>"),n.document.write(t),n.document.write("<hr/>"),n.document.write("<p>"),n.document.write('<img src="http://p3.3playmedia.com/images/logo/interactive-transcript-logo-black.png"/>'),n.document.write("</p>"),n.document.write("</body></html>"),n.document.close(),e||n.print(),!1},selected_html:function(){try{var t;if(window.getSelection){if(t=window.getSelection(),t.getRangeAt)var e=t.getRangeAt(0);else{var e=document.createRange();e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset)}var n=e.cloneContents(),a=n.childNodes;for(i=0;i<a.length;i++)a[i].style&&(a[i].style.backgroundColor="#fff");var r=document.createElement("div");return r.appendChild(n),r.innerHTML}return document.selection?(t=document.selection.createRange(),t.htmlText):!1}catch(s){return!1}},window_dimensions:function(){var t=630,e=460;return document.body&&document.body.offsetWidth&&(t=document.body.offsetWidth,e=document.body.offsetHeight),"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.offsetWidth&&(t=document.documentElement.offsetWidth,e=document.documentElement.offsetHeight),window.innerWidth&&window.innerHeight&&(t=window.innerWidth,e=window.innerHeight),{width:t,height:e}},is_ipod_touch:function(){return null!=navigator.userAgent.match(/iPod/i)||null!=navigator.userAgent.match(/iPhone/i)},is_ios:function(){return null!=navigator.userAgent.match(/iPad/i)||null!=navigator.userAgent.match(/iPod/i)||null!=navigator.userAgent.match(/iPhone/i)},is_ipad:function(){return null!=navigator.userAgent.match(/iPad/i)},is_ie:function(){return P3.JQuery.browser.msie},is_ie6:function(){return P3.JQuery.browser.msie&&parseInt(P3.JQuery.browser.version)<7},is_old_ie:function(){return P3.JQuery.browser.msie&&parseInt(P3.JQuery.browser.version)<9},is_android:function(){return/android/i.test(navigator.userAgent)},is_mobile:function(){return P3.Util.is_android()||P3.Util.is_ios()},nice_searchbox:function(t){var e=t.classname||"a",i=t.placeholder||"";return setTimeout(function(){P3.JQuery.browser.webkit&&P3.JQuery("."+e).val("")},10),'<input type="text" class="p3-nice-search srch_fld '+e+'" placeholder="'+i+'" autosave="bsn_srch" results="5" />'},shorten_url:function(t,e,i){var n="3playmedia",a="R_586ba8f060b4fbccf2b5978d88f40fcc",r="http://api.bit.ly/v3/shorten?login="+n;/https/.test(location.protocol)&&(r="https://api-ssl.bit.ly/v3/shorten?login="+n),r+="&apiKey="+a,r+="&longUrl="+encodeURIComponent(t),r+="&format=json&callback=?",P3.JQuery.getJSON(r,function(t){var n=t.data.url;i&&i(n,e)})},render_segment_map:function(t,e,n){var a=40,r=Math.min(t.total_num,a),s=Math.ceil(t.total_num/r),o=Math.ceil(t.total_num/s),p=e.video_id,c=e.file_id,l=P3.JQuery("<table></table>"),d=P3.JQuery("<tbody></tbody>"),_=P3.JQuery("<tr></tr>");P3.JQuery(d).append(_),P3.JQuery(l).append(d);var h={};for(P3.JQuery.each(t,function(t,e){h[e.number]=e.timestamp}),i=0;i<o;i++){var u=P3.JQuery("<td></td>");P3.JQuery(u).attr("num",s*i+1),P3.JQuery(u).attr("segs_per",s),P3.JQuery(u).attr("video_id",p),P3.JQuery(u).attr("file_id",c),P3.JQuery(u).html("<span>"+n+"</span>"),P3.JQuery(_).append(u)}return P3.JQuery(_).attr("video_id",p),P3.JQuery(_).attr("file_id",c),P3.JQuery.each(t.hits,function(e){var i=Math.floor((t.hits[e].number-1)/s);P3.JQuery(l).find("td:eq("+i+")").removeClass("*").addClass("hit")}),P3.JQuery(l).html()},mouse_coords:function(t){return t.pageX||t.pageY?{x:t.pageX,y:t.pageY}:t.clientX||t.clientY?{x:t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:t.clientY+document.body.scrollTop+document.documentElement.scrollTop}:void 0}};var p3_window_loaded=!1,p3_loader_complete=!1,p3_already_loaded=!1,p3_handled_dependencies=[];p3_window_wait="undefined"==typeof p3_window_wait?!0:p3_window_wait,p3_jquery_ui="undefined"==typeof p3_jquery_ui?!0:p3_jquery_ui,p3_external_stylesheet="undefined"==typeof p3_external_stylesheet?!1:p3_external_stylesheet,p3_hosted_extensions="undefined"==typeof p3_hosted_extensions?[]:p3_hosted_extensions,p3_extensions="undefined"==typeof p3_extensions?[]:p3_extensions,function(t,e,i,n){var a=!1,r=this,s={},o=[];this.all_loaded=function(){for(var t=0;t<o.length;t++)if(!(status=s[o[t]])&&"loaded"!=status&&"complete"!=status)return!1;return!0},this.run_script=function(){return a?!0:(P3.JQuery=jQuery.noConflict(!0),p3_jquery_ui&&P3.Util.load_remote_script("//p3.3playmedia.com/javascripts/vendor/p3-jquery-ui-1.8.16.custom.min.js"),void n(P3.JQuery,a=!0))},this.load_script=function(t){o.push(t)},this.run=function(t){if(o[t]){var i=o[t],n=t,s=/\.css$/i.test(i.replace(/\?.*/,"")),p=e.createElement(s?"link":"script");if(p.type=s?"text/css":"text/javascript",s?(p.rel="stylesheet",p.href=i):p.src=i,s){var c=e.getElementsByTagName("head")[0];c=c||e.body,c.appendChild(p),r.run(n+1)}else if(p.onload=p.onreadystatechange=function(){return"undefined"!=typeof p.readyState&&"complete"!=p.readyState&&"loaded"!=p.readyState?!1:void(o.length-1==n&&0==a?r.run_script():r.run(n+1))},!P3.Util.in_array(i,p3_handled_dependencies)){var c=e.getElementsByTagName("head")[0];c=c||e.body,c.appendChild(p),p3_handled_dependencies.push(i)}}else r.run_script()};var p="p3.3playmedia.com",c=[],l="/stylesheets/p3.css",d=[p+l];p3_external_stylesheet&&d.push(p3_external_stylesheet),c.push(p+"/javascripts/vendor/ejs_production.js"),c.push(p+"/javascripts/vendor/jquery-1.6.2.min.js");try{if(p3_extensions&&p3_extensions.length>0)for(var _=0;_<p3_extensions.length;_++)c.push(p3_extensions[_].replace(/^https*\:\/\//,""))}catch(h){}var u=[];for(_ in P3.About.hosted_extensions)u.push(_);if(p3_hosted_extensions&&p3_hosted_extensions.length>0)for(var _=0;_<p3_hosted_extensions.length;_++)if(u.indexOf(p3_hosted_extensions[_])>=0){var f=p+"/javascripts/extensions/"+p3_hosted_extensions[_]+"/"+p3_hosted_extensions[_]+".js",m=p+"/javascripts/extensions/"+p3_hosted_extensions[_]+"/"+p3_hosted_extensions[_]+".css";c.push(f),d.push(m),p3_extensions.push(p3_hosted_extensions[_])}else console&&console.log&&console.log("Warning: P3 Hosted Extension '"+p3_hosted_extensions[_]+"' was not found.");for(var _=0;_<d.length;_++)load_script(e.location.protocol+"//"+d[_]);for(var _=0;_<c.length;_++)load_script(e.location.protocol+"//"+c[_]);this.run(0)}(window,document,"1.6.2",function(){p3_loader_complete=!0,run_p3()}),window.addEventListener?window.addEventListener("load",function(){p3_window_loaded=!0,p3_window_wait&&run_p3()},!1):window.attachEvent?window.attachEvent("onload",function(){p3_window_loaded=!0,p3_window_wait&&run_p3()}):p3_window_loaded=!0,P3.thePlatform_init=function(t,e){var i=function(t){var e=t.data.baseClip.contentID;a(e)},n=function(t){var e=t.data.id.split("/").slice(-1)[0];a(e)},a=function(a){$(".tpLayout").append("<div id='interactive_transcript'></div>"),"undefined"==typeof e&&(e={}),"undefined"==typeof e.skin&&(e.skin="ice"),"undefined"==typeof e.template&&(e.template="default"),"undefined"==typeof e.progressive_tracking&&(e.progressive_tracking=!1),"undefined"==typeof e.track_spoken_words&&(e.track_spoken_words=!0),"undefined"==typeof e.light_scroll&&(e.light_scroll=!0),"undefined"==typeof e.can_print&&(e.can_print=!0),"undefined"==typeof e.can_download&&(e.can_download=!0),"undefined"==typeof e.download_format&&(e.download_format="pdf"),"undefined"==typeof e.scan_view&&(e.scan_view=!0),"undefined"==typeof e.can_clip&&(e.can_clip=!0),"undefined"==typeof e.search_strict_mode&&(e.search_strict_mode=!1),"undefined"==typeof e.height&&(e.height=372),P3.init({player:{player_type:"theplatform",platform_integration:!0,project_id:t,file_id:a,api_version:"simple",transcript:{target:"interactive_transcript",skin:e.skin,template:e.template,progressive_tracking:e.progressive_tracking,track_spoken_words:e.track_spoken_words,light_scroll:e.light_scroll,width:"100%",height:e.height,can_print:e.can_print,can_download:e.can_download,download_format:e.download_format,scan_view:e.scan_view||!0,can_clip:e.can_clip||!0,search_strict_mode:e.search_strict_mode||!1}}},""),"undefined"==typeof e.x&&"undefined"==typeof e.y?$("#interactive_transcript").css("position","relative"):($("#interactive_transcript").css("position","absolute"),"undefined"==typeof e.x&&(e.x=0),"undefined"==typeof e.y&&(e.y=0),$("#interactive_transcript").css("left",e.x),$("#interactive_transcript").css("top",e.y)),$pdk.controller.removeEventListener("OnMediaLoadStart",i),$pdk.controller.removeEventListener("OnLoadReleaseUrl",n)};$pdk.controller.addEventListener("OnMediaLoadStart",i),$pdk.controller.addEventListener("OnLoadReleaseUrl",n)},P3.Settings={host:null,is_ssl:/https/.test(document.location.protocol),api_host:document.location.protocol+"//api.3playmedia.com",api_key:null,api_version:2,static_host:document.location.protocol+"//static.3playmedia.com",p3_host:document.location.protocol+"//p3.3playmedia.com",platform_integration:!1,debug:!1,debugger_ui:!1,domain:document.domain,major_version:"3",version:"3.3",player_tracking_interval:250,disable_tooltips:!1},P3.Cookies={set_cookie:function(t,e,i){var n=new Date;n.setDate(n.getDate()+i);var a=escape(e)+(null==i?"":"; expires="+n.toUTCString());document.cookie=t+"="+a},get_cookie:function(t){var e,i,n,a=document.cookie.split(";");for(e=0;e<a.length;e++)if(i=a[e].substr(0,a[e].indexOf("=")),n=a[e].substr(a[e].indexOf("=")+1),i=i.replace(/^\s+|\s+$/g,""),i==t)return unescape(n)}},P3.Log={log:function(t){return P3.debugger_ui&&P3.debugger_ui.logger(t),P3.Settings.debug?void("undefined"!=typeof window.console&&"undefined"!=typeof window.console.log&&console.log(t)):!1},debug:function(t){return P3.Settings.debug?void("undefined"!=typeof window.console&&"undefined"!=typeof window.console.debug&&console.debug(t)):!1},info:function(t){return P3.Settings.debug?void("undefined"!=typeof window.console&&"undefined"!=typeof window.console.info&&console.info(t)):!1},warn:function(t){return P3.Settings.debug?void("undefined"!=typeof window.console&&"undefined"!=typeof window.console.warn&&console.warn(t)):!1},error:function(t,e){return P3.Settings.debug?void("undefined"!=typeof window.console&&"undefined"!=typeof window.console.error?console.error(t):e&&e(t)):!1},object:function(t){return P3.Settings.debug?void("undefined"!=typeof window.console&&"undefined"!=typeof window.console.dir&&console.dir(t)):!1}},P3.Event=function(t){var e=this;this.instance=t,this.trigger=function(t,i){var t=t,i=i;setTimeout(function(){P3.JQuery(e.instance).trigger(t,i)},0),event_name=t.split("."),P3.Log.debug("Event Triggered: "+t),P3.debugger_ui&&P3.debugger_ui.event_logger(t,i)},this.Player={Progress:function(){}}},P3.Player=function(t,e,n){var a=this,r=P3.JQuery;this.instance=t,this.player_id=e,this.player=r("#"+e),this.interval=!1,this.last_m=-99,this["interface"]=!1,this.find_player_interval=setInterval(function(){if(/closest\_player/.test(e))try{var t=r("object,embed").get(0);if(t||(t=r("iframe").get(0)),!t)return!1;r(t).attr("id")||r(t).attr("id","3play_auto_id"),e=r(t).attr("id"),a.instance.player_reference=e,a.player_id=e,a.player=r("#"+e),"auto"==a.instance.settings.player_type&&(a.instance.settings.player_type=P3.Util.player_type(e))}catch(s){return!1}if("auto"==a.instance.settings.player_type&&(a.instance.settings.player_type=P3.Util.player_type(e)),n.html5_container_id&&r("#"+n.html5_container_id).find("video,audio").length>0){if(a.player=r("#"+n.html5_container_id).find("video,audio:first"),a.player_id=r(a.player).attr("id"),!a.player_id){var o="tpm_"+parseInt(1e8*Math.random());r(a.player).attr("id",o),a.player_id=o}a.instance.settings.player_type="html5",a.instance.player_reference=a.player_id}if(P3.Log.debug("Finding player with ID "+e+"..."),a["interface"]&&a["interface"].position&&clearInterval(a.find_player_interval),!r("#"+e))return!1;var p=a.instance.settings.player_type||P3.Util.player_type(e);p=p.toLowerCase().replace(/^\s+|\s+$/,""),a.player_type=p;try{a["interface"]=new P3.PlayerInterface[p](a.instance.player_reference,a.instance),a.instance.event.trigger("Player.Ready",{player_id:e,player_type:p}),clearInterval(a.find_player_interval)}catch(s){P3.Log.error(s),a["interface"]=!1;var c=[];for(i in P3.PlayerInterface)c.push(i);if(P3.Util.in_array(p,c))return!1;P3.Util.alert("Player Type "+p+" is not supported.\nSupported Players: "+c.join(", "))}},250),this.start_tracking=function(){a.interval=setInterval(function(){if(a["interface"]&&a["interface"].play_state&&"PLAYING"==a["interface"].play_state()){var t=a["interface"].position(),e=a.instance.settings.platform_integration?a["interface"].video_id():!1;a.instance.event.trigger("Player.Progress",{m:t,video_id:e}),a.last_m=t}},P3.Settings.player_tracking_interval)},this.stop_tracking=function(){clearInterval(a.interval)},this.load_video=function(t){return t.video_id?(a["interface"].play_file(t),m=t.m||0,a.instance.settings.file_id=t.video_id,void a.instance.event.trigger("Player.VideoLoad",{video_id:t.video_id,m:m})):!1},r(t).bind("Player.Ready",function(){a.onload_seek_handled||!P3.Util.params("p3s")||P3.Util.params("p3i")&&P3.Util.params("p3i")!=a.instance.instance_index||(a.ready_to=setInterval(function(){return a["interface"]&&a["interface"].play?(a["interface"].play(),void clearInterval(a.ready_to)):!1},10))}),r(t).bind("Player.Progress",function(t,e){if(a.onload_seek_handled||!P3.Util.params("p3s")||P3.Util.params("p3i")&&P3.Util.params("p3i")!=a.instance.instance_index)if(a.play_video_id)a.play_video_id!=a["interface"].video_id()&&a["interface"].play_file({video_id:a.play_video_id}),a.play_video_id=!1;else if(a.seek_to_m&&"PLAYING"==a["interface"].play_state()){if(a.instance.player.seek_to_video_id){if(a.instance.player.seek_to_video_id!=a.instance.player["interface"].video_id())return!1;a.instance.player.seek_to_video_id=!1}a["interface"].seek(a.seek_to_m),a.seek_to_m=!1}else a.pause_at_m&&a.pause_at_m<e.m-1e3&&(a["interface"].pause(),a.pause_at_m=!1);else{var i=parseInt(P3.Util.params("p3s"),10);a.onload_seek_handled=!0,a["interface"].play(),a.play_video_id=P3.Util.params("p3v")||!1,a.seek_to_m=i,a.pause_at_m=P3.Util.params("p3e")||!1}}),this.start_tracking()},P3.PlayerInterface={brightcove:function(t,e){if(brightcove&&brightcove.api&&brightcove.api.getExperience(t)){var i=this;if(i.instance=e,this.bcExp=brightcove.api.getExperience(t),this.modVP=this.bcExp.getModule(brightcove.api.modules.APIModules.VIDEO_PLAYER),this.modExp=this.bcExp.getModule(brightcove.api.modules.APIModules.EXPERIENCE),this.modCon=this.bcExp.getModule(brightcove.api.modules.APIModules.CONTENT),!this.modVP.addEventListener)throw"not_ready";this.modVP.addEventListener(brightcove.api.events.MediaEvent.PROGRESS,function(t){i.player_info.position=parseInt(1e3*parseFloat(t.position),10),i.player_info.videoid=t.media.id}),this.player_info={position:0,is_playing:!1},this.play=function(){return this.modVP.play()},this.pause=function(){return this.modVP.pause()},this.play_state=function(){return this.modVP.getIsPlaying(function(t){i.player_info.is_playing=t}),i.player_info.is_playing?"PLAYING":"PAUSED"},this.position=function(){return this.player_info.position},this.duration=function(){return this.modVP.getVideoDuration(function(t){i.player_info.duration=1e3*t}),i.player_info.duration||!1},this.video_id=function(){return this.modVP.getCurrentVideo(function(t){i.player_info.videoid=t.id}),i.player_info.videoid||!1},this.seek=function(t){"PAUSED"==this.play_state()?(this.play(),setTimeout(function(){i.modVP.seek(parseInt(t/1e3,10))},100)):this.modVP.seek(parseInt(t/1e3,10))},this.play_file=function(t){t.video_id!=this.video_id()?(this.modVP.loadVideoByID(t.video_id),i.instance.player.seek_to_m=t.m||0,i.instance.player.seek_to_video_id=t.video_id):this.seek(t.m)}}else{if(!brightcove||"undefined"==typeof brightcove.modules||!brightcove.getExperience(t))throw"not_ready";var i=this;if(i.instance=e,this.bcExp=brightcove.getExperience(t),this.modVP=this.bcExp.getModule(APIModules.VIDEO_PLAYER),this.modExp=this.bcExp.getModule(APIModules.EXPERIENCE),this.modCon=this.bcExp.getModule(APIModules.CONTENT),!this.modVP.addEventListener)throw"not_ready";this.modVP.addEventListener(BCMediaEvent.PLAY,function(){}),this.modVP.addEventListener(BCMediaEvent.STOP,function(){}),this.modVP.addEventListener(BCMediaEvent.BEGIN,function(){}),this.modVP.addEventListener(BCMediaEvent.PROGRESS,function(t){i.player_info.position=parseInt(1e3*parseFloat(t.position),10),i.player_info.videoid=t.media.id}),this.modExp.addEventListener(BCExperienceEvent.CONTENT_LOAD,function(){}),this.player_info={position:0},this.play=function(){return this.modVP.play()},this.pause=function(){return this.modVP.pause()},this.play_state=function(){return this.modVP.isPlaying()?"PLAYING":"PAUSED"},this.position=function(){return this.player_info.position},this.duration=function(){return 1e3*this.modVP.getVideoDuration()},this.video_id=function(){return this.modVP.getCurrentVideo().id},this.seek=function(t){"PAUSED"==this.play_state()?(this.play(),setTimeout(function(){i.modVP.seek(parseInt(t/1e3,10))},100)):this.modVP.seek(parseInt(t/1e3,10))},this.play_file=function(t){t.video_id!=this.video_id()?(this.modVP.loadVideo(t.video_id),i.instance.player.seek_to_m=t.m||0,i.instance.player.seek_to_video_id=t.video_id):this.seek(t.m)}}},delve:function(t,e){var i=this;if(i.instance=e,"undefined"==typeof DelvePlayer)throw"not_ready";this.delve_id=t,DelvePlayer.registerPlayer(t),this.delve_player=function(){return DelvePlayer.getPlayerNodeByIdOrName(i.delve_id)},this.play=function(){i.delve_player().doPlay()},this.pause=function(){i.delve_player().doPause()},this.play_state=function(){return i.delve_player().doGetCurrentPlayState().isPlaying?"PLAYING":"PAUSED"},this.position=function(){return i.delve_player().doGetPlayheadPositionInMilliseconds()},this.duration=function(){return i.delve_player().doGetCurrentMedia().durationInMilliseconds},this.video_id=function(){return i.delve_player().doGetCurrentMedia().id},this.seek=function(t){i.delve_player().doSeekToSecond(t/1e3)},this.play_file=function(t){t.video_id!=this.video_id()?(i.delve_player().doLoadMedia(t.video_id,!0),i.instance.player.seek_to_m=t.m||0,i.instance.player.seek_to_video_id=t.video_id):this.seek(t.m)}},flowplayer:function(t,e){var i=this;if(i.instance=e,"undefined"==typeof flowplayer)throw"not_ready";this.flow_player=t,this.play=function(){return flowplayer(this.flow_player).play()},this.pause=function(){return flowplayer(this.flow_player).pause()},this.play_state=function(){var t=flowplayer(this.flow_player).getState();switch(t){case 3:return"PLAYING";default:return"PAUSED"}},this.position=function(){return 1e3*flowplayer(this.flow_player).getTime()},this.duration=function(){return 1e3*parseFloat(flowplayer(this.flow_player).getClip().fullDuration())},this.video_id=function(){return flowplayer(this.flow_player).getClip().url.replace(/^.+?\:/,"")},this.seek=function(t){var e=Math.max(0,t/1e3-1);flowplayer(this.flow_player).seek(e)}},jw:function(t,e){var i=this;if(i.instance=e,"undefined"!=typeof jwplayer&&jwplayer(t)&&jwplayer(t).play)this.jw_player=jwplayer(t),this.play=function(){i.jw_player.play()},this.pause=function(){i.jw_player.pause()},this.play_state=function(){return"PLAYING"==i.jw_player.getState()?"PLAYING":"PAUSED"},this.position=function(){return 1e3*i.jw_player.getPosition()},this.duration=function(){return 1e3*i.jw_player.getDuration()},this.video_id=function(){try{var t=i.jw_player.getPlaylistItem().sources[0].file.split("/").slice(-1)[0];return t}catch(e){return""}},this.seek=function(t){i.jw_player.seek(t/1e3)};else{if(!window.document[t]||"undefined"==typeof window.document[t].addModelListener)throw"not_ready";this.jw_player=window.document[t],p3_jw_interfaces[t]=new PlayerInterfaceExtension_JW(this),this.jw_player.addModelListener("STATE",'p3_jw_interfaces["'+t+'"].play_handler'),this.jw_player.addModelListener("TIME",'p3_jw_interfaces["'+t+'"].playhead_handler'),this.play=function(){i.jw_player.sendEvent("PLAY","true")},this.pause=function(){i.jw_player.sendEvent("PLAY","false")},this.play_state=function(){return this.player_state},this.position=function(){return this.playhead_time},this.duration=function(){return 1e3*this.jw_player.getPlaylist()[i.jw_player.getConfig().item].duration},this.video_id=function(){var t=this.jw_player.getPlaylist()[i.jw_player.getConfig().item].file;return t.split(/\//).slice(-1)[0].replace(/\-.*$/,"")},this.seek=function(t){var e=parseInt(t,10)/1e3;e=Math.max(0,e-1),i.jw_player.sendEvent("SEEK",e)}}},kaltura:function(t,e){var i=this;if(i.instance=e,this.kaltura_player=P3.JQuery("#"+t).get(0),this.kaltura_player||(this.kaltura_player=P3.JQuery(".kWidgetIframeContainer").get(0)),!this.kaltura_player||!this.kaltura_player.addJsListener)throw"not_ready";this.player_state=!1,this.playhead_time=0,this.player_id=t,P3.JQuery(i.kaltura_player).find("iframe").length>0?(window["kaltura_handler_"+t]={pid:t,playhead_time:0,onplay:function(){window.P3.get(this.pid.replace("pid_","")).player["interface"].player_state="PLAYING"},onpause:function(){window.P3.get(this.pid.replace("pid_","")).player["interface"].player_state="PAUSED"},onprogress:function(t){window.P3.get(this.pid.replace("pid_","")).player["interface"].player_state="PLAYING",this.playhead_time=1e3*parseFloat(t),window.P3.get(this.pid.replace("pid_","")).player["interface"].playhead_time=1e3*parseFloat(t)}},i.kaltura_player.addJsListener("playerPlayed","kaltura_handler_"+t+".onplay"),i.kaltura_player.addJsListener("playerPaused","kaltura_handler_"+t+".onpause"),i.kaltura_player.addJsListener("playerPlayEnd","kaltura_handler_"+t+".onpause"),i.kaltura_player.addJsListener("playerUpdatePlayhead","kaltura_handler_"+t+".onprogress")):(p3_kaltura_interfaces[i.player_id]=new PlayerInterfaceExtension_Kaltura(i),i.kaltura_player.addJsListener("playerPlayed",'p3_kaltura_interfaces["'+i.player_id+'"].play_handler'),i.kaltura_player.addJsListener("playerPaused",'p3_kaltura_interfaces["'+i.player_id+'"].pause_handler'),i.kaltura_player.addJsListener("playerPlayEnd",'p3_kaltura_interfaces["'+i.player_id+'"].pause_handler'),i.kaltura_player.addJsListener("playerUpdatePlayhead",'p3_kaltura_interfaces["'+i.player_id+'"].playhead_handler')),this.play=function(){this.kaltura_player.sendNotification("doPlay")},this.pause=function(){this.kaltura_player.sendNotification("doPause")},this.play_state=function(){try{if(0==this.player_state)return"PLAYING"}catch(t){}return this.player_state},this.position=function(){try{var t=1e3*this.kaltura_player.evaluate("{video.player.currentTime}");return t}catch(e){}return this.playhead_time},this.duration=function(){return this.kaltura_player.evaluate("{mediaProxy.entry.msDuration}")},this.video_id=function(){return this.kaltura_player.evaluate("{mediaProxy.entry.id}")},this.seek=function(t){this.kaltura_player.sendNotification("doSeek",parseFloat(parseInt(t)/1e3))},this.play_file=function(t){if(t.video_id!=this.video_id()){var e=t.m||0;this.kaltura_player.sendNotification("changeMedia",{entryId:t.video_id,seekFromStart:e.toString()}),this.timer=setInterval(function(){return"PLAYING"==i.play_state()&&i.video_id()==t.video_id?(clearInterval(i.timer),!0):void i.play()},200)}else this.seek(t.m)}},ooyala:function(t,e){var i=this;if(i.instance=e,window[t]&&"undefined"!=typeof window[t].play)this.play=function(){window[t].play()},this.pause=function(){window[t].pause()},this.play_state=function(){return"playing"==window[t].state?"PLAYING":"PAUSED"},this.position=function(){return parseInt(1e3*(window[t].playheadTime||0),10)},this.duration=function(){return parseInt(1e3*window[t].getDuration(),10)},this.seek=function(e){var e=parseInt(e,10)/1e3;window[t].setPlayheadTime(e)},this.video_id=function(){return window[t].getCurrentItemEmbedCode()},this.play_file=function(e){e.video_id!=i.video_id()?(m=e.m||0,window[t].setEmbedCode(e.video_id),i.instance.player.seek_to_m=m,i.instance.player.seek_to_video_id=e.video_id):i.seek(e.m)};else if(P3.Util.is_ipad()){if(this.ooyala_player=P3.JQuery(".OoyalaHtml5VideoPlayer").get(0),!this.ooyala_player)throw"not_ready";this.ooyala_player=function(){return P3.JQuery(".OoyalaHtml5VideoPlayer").get(0)},this.ooyala_video_tag=function(){return P3.JQuery(this.ooyala_player()).find("video:first").get(0)},this.play=function(){this.ooyala_player().playMovie()},this.pause=function(){this.ooyala_player().pauseMovie()
},this.play_state=function(){return this.ooyala_video_tag().paused?"PAUSED":"PLAYING"},this.position=function(){return parseInt(1e3*this.ooyala_video_tag().currentTime,10)},this.duration=function(){return parseInt(1e3*this.ooyala_video_tag().duration,10)},this.video_id=function(){return this.ooyala_player().getEmbedCode()},this.seek=function(t){var t=parseInt(t,10)/1e3;t=Math.max(0,t-1),this.ooyala_video_tag().currentTime=t},this.play_file=function(t){t.video_id!=i.video_id()?(m=t.m||0,this.ooyala_player().setQueryStringParameters({embedCode:t.video_id,autoplay:1}),i.instance.player.seek_to_m=m,i.instance.player.seek_to_video_id=t.video_id):this.seek(t.m)}}else{if(!p3_ooyala_interfaces[t])throw"not_ready";this.ooyala_player=window.document[t],this.playhead_time=0,this.total_time=0,this.play=function(){this.ooyala_player.playMovie()},this.pause=function(){this.ooyala_player.pauseMovie()},this.play_state=function(){return this.ooyala_player.getState().toUpperCase()},this.position=function(){return this.playhead_time},this.duration=function(){return this.total_time},this.video_id=function(){return this.ooyala_player.getCurrentItemEmbedCode()},this.seek=function(t){var e=Math.max(0,parseInt(t,10)/1e3-1);this.ooyala_player.setPlayheadTime(e)},this.play_file=function(t){t.video_id!=i.video_id()?(m=t.m||0,this.ooyala_player.setQueryStringParameters({embedCode:t.video_id,autoplay:1}),i.instance.player.seek_to_m=m,i.instance.player.seek_to_video_id=t.video_id):this.seek(t.m)}}},theplatform:function(t,e){var i=this;if(i.instance=e,this.player_id=t,"undefined"==typeof $pdk)throw"not_ready";this.player=$pdk.controller,this.current_position=0,this.current_state="PLAYING",this.current_duration=0,this.has_started=!1,this.video_id=function(){return i.file_id},this.player.addEventListener("OnMediaLoadStart",function(t){i.file_id=t.data.baseClip.contentID}),this.player.addEventListener("OnMediaStart",function(){i.has_started=!0}),this.player.addEventListener("OnMediaPlaying",function(t){i.current_position=t.data.currentTime,i.current_duration=t.data.duration,i.current_state="PLAYING",i.seek_to_position&&i.seek_to_position>0&&(i.player.seekToPosition(i.seek_to_position),i.seek_to_position=!1)}),this.player.addEventListener("OnMediaPause",function(){i.current_state="PAUSED"}),this.play=function(){i.player.clickPlayButton()},this.pause=function(){i.player.pause(!0)},this.play_state=function(){return i.current_state},this.position=function(){return i.current_position},this.duration=function(){return i.current_duration},this.seek=function(t){0==i.has_started?(i.player.clickPlayButton(),i.seek_to_position=t):(i.player.pause(!1),i.player.seekToPosition(t))}},video_js:function(t,e){var i=this;if(i.instance=e,this.player_id=t,"undefined"==typeof _V_&&"undefined"!=typeof videojs&&(_V_=videojs),"undefined"==typeof _V_)throw"not_ready";this.play=function(){_V_(t).play()},this.pause=function(){_V_(t).pause()},this.play_state=function(){return _V_(t).paused()?"PAUSED":"PLAYING"},this.position=function(){return 1e3*_V_(t).currentTime()},this.duration=function(){return 1e3*_V_(t).duration()},this.video_id=function(){return!1},this.seek=function(e){var n=parseInt(e,10)/1e3;_V_(t).currentTime(n),i.play()},this.play_file=function(){return!1}},viddler:function(t,e){var i=this;i.instance=e,this.player_id=t,this.viddler_player=window[t],this.play=function(){i.viddler_player.manager.play()},this.pause=function(){i.viddler_player.manager.pause()},this.play_state=function(){return"PLAYING"==i.viddler_player.manager.status.toUpperCase()?"PLAYING":"PAUSED"},this.position=function(){return parseInt(i.viddler_player.manager.currentTime,10)},this.duration=function(){return i.viddler_player.videoPlayer.duration},this.video_id=function(){return i.viddler_player.videoId},this.seek=function(t){i.viddler_player.manager.play(t)},this.play_file=function(){return!1}},viddler_v3:function(t){this.playerInstance=window[t],this.play=function(){this.playerInstance.manager.play()},this.pause=function(){this.playerInstance.manager.pause()},this.play_state=function(){return"playing"==this.playerInstance.manager.status?"PLAYING":"PAUSED"},this.seek=function(t){this.play(),this.playerInstance.manager.seekTo(t)},this.position=function(){return parseInt(this.playerInstance.manager.currentTime)},this.duration=function(){return this.playerInstance.manager.currentPrimaryTrack.mediaElements[0].duration}},vimeo:function(t,e){var i=this;return i.instance=e,this.player_state=!1,this.playhead_time=0,this.vimeo_player=document.getElementById(t),"undefined"==typeof this.vimeo_player||"undefined"==typeof this.vimeo_player.api_addEventListener?!1:(p3_vimeo_interfaces[t]=new PlayerInterfaceExtension_Vimeo(this),this.vimeo_player.api_addEventListener("onPlay",'p3_vimeo_interfaces["'+t+'"].play_handler'),this.vimeo_player.api_addEventListener("onPause",'p3_vimeo_interfaces["'+t+'"].pause_handler'),this.vimeo_player.api_addEventListener("onLoading",'p3_vimeo_interfaces["'+t+'"].pause_handler'),this.vimeo_player.api_addEventListener("onFinish",'p3_vimeo_interfaces["'+t+'"].pause_handler'),this.vimeo_player.api_addEventListener("onProgress",'p3_vimeo_interfaces["'+t+'"].playhead_handler'),this.play=function(){this.vimeo_player.api_play()},this.pause=function(){this.vimeo_player.api_pause()},this.play_state=function(){return this.player_state},this.position=function(){return this.playhead_time},this.duration=function(){return this.vimeo_player.api_getDuration()},this.video_id=function(){try{var t=P3.JQuery(this.vimeo_player).find("param[name=flashVars]").val();return t.match(/clip\_id\=(\d+)\&*/)[1]}catch(e){return null}},void(this.seek=function(t){var e=Math.max(0,t/1e3-1);this.vimeo_player.api_seekTo(e)}))},vimeo_iframe:function(t,e){var i=this;if(i.instance=e,this.vimeo_player_id=t,"undefined"==typeof $f)throw"not_ready";if(this.vimeo_player=$f(t),!this.vimeo_player)throw"not_ready";this.playhead_time=0,this.player_state="PAUSED",this.duration=!1,p3_vimeo_iframe_interfaces[t]=new PlayerInterfaceExtension_VimeoIframe(this),this.vimeo_player.addEvent("play",function(t){p3_vimeo_iframe_interfaces[i.vimeo_player_id].play_handler(t)}),this.vimeo_player.addEvent("onPause",function(t){p3_vimeo_iframe_interfaces[i.vimeo_player_id].pause_handler(t)}),this.vimeo_player.addEvent("onLoading",function(t){p3_vimeo_iframe_interfaces[i.vimeo_player_id].pause_handler(t)}),this.vimeo_player.addEvent("onFinish",function(t){p3_vimeo_iframe_interfaces[i.vimeo_player_id].pause_handler(t)}),this.vimeo_player.addEvent("playProgress",function(t,e){p3_vimeo_iframe_interfaces[i.vimeo_player_id].playhead_handler(t,e)}),this.play=function(){i.vimeo_player.api("play")},this.pause=function(){i.vimeo_player.api("pause")},this.play_state=function(){return this.player_state},this.position=function(){return this.playhead_time||0},this.duration=function(){return i.duration?duration:void i.vimeo_player.get("getDuration",function(t){i.duration=t})},this.seek=function(t){var e=Math.max(0,t/1e3-1);i.vimeo_player.api("seekTo",e)},this.video_id=function(){try{var t=i.vimeo_player.element.src.split("/").slice(-1)[0].replace(/\?.*/,"");return t}catch(e){return!1}}},wistia:function(t,e){var i=this;i.instance=e,this.wistia_player=window.document[t],("undefined"==typeof this.wistia_player||"undefined"==typeof this.wistia_player.videoPlay)&&(this.wistia_player=P3.JQuery("embed[name="+t+"]")),("undefined"==typeof this.wistia_player||"undefined"==typeof this.wistia_player.videoPlay)&&(this.wistia_player=P3.JQuery("#"+t).find("embed").get(0)),("undefined"==typeof this.wistia_player||"undefined"==typeof this.wistia_player.videoPlay)&&(this.wistia_player=P3.JQuery("#"+t).find("object").get(0)),this.play=function(){i.wistia_player.videoPlay()},this.pause=function(){i.wistia_player.videoPause()},this.play_state=function(){return 1==i.wistia_player.getCurrentState()?"PLAYING":"PAUSED"},this.position=function(){return 1e3*i.wistia_player.getCurrentTime()},this.duration=function(){return 1e3*parseInt(i.wistia_player.getDuration())},this.video_id=function(){return!1},this.seek=function(t){var e=(t-2500)/1e3;i.wistia_player.videoSeek(Math.max(0,e))}},wistia_iframe:function(t,e){var i=this;if(i.instance=e,this.wistia_player=document.getElementById(t),"undefined"==typeof this.wistia_player)throw"not_ready";if("undefined"==typeof this.wistia_player.wistiaApi)throw"not_ready";this.play=function(){i.wistia_player.wistiaApi.play()},this.pause=function(){i.wistia_player.wistiaApi.pause()},this.play_state=function(){return"playing"==i.wistia_player.wistiaApi.state().toLowerCase()?"PLAYING":"PAUSED"},this.position=function(){return 1e3*i.wistia_player.wistiaApi.time()},this.duration=function(){return 1e3*i.wistia_player.wistiaApi.duration()},this.video_id=function(){return!1},this.seek=function(t){var e=t/1e3;i.wistia_player.wistiaApi.time(e).play()}},youtube:function(t,e){var i=this;if(i.instance=e,document.getElementById(t)&&"iframe"==document.getElementById(t).tagName.toLowerCase()){if("undefined"==typeof YT||"undefined"==typeof YT.Player)throw"not_ready";if(!YT.loaded)throw"not_ready";if(i.instance.ytplayerloaded)throw"not_ready";i.youtube_player=new YT.Player(t),i.instance.ytplayerloaded=!0}else this.youtube_player=window.document[t];this.play=function(){this.youtube_player.playVideo()},this.pause=function(){this.youtube_player.pauseVideo()},this.play_state=function(){try{var t=this.youtube_player.getPlayerState()}catch(e){return"PAUSED"}return 1==parseInt(t)||5==parseInt(t)?"PLAYING":"PAUSED"},this.position=function(){return parseInt(1e3*this.youtube_player.getCurrentTime()+.5)},this.duration=function(){return this.youtube_player?parseInt(1e3*this.youtube_player.getDuration()+.5):!1},this.video_id=function(){try{var t=this.youtube_player.getVideoUrl().replace(/^[^v]+v.(.{11}).*/,"$1");return t}catch(e){return null}},this.seek=function(t){var t=parseInt(t,10)/1e3;this.youtube_player.seekTo(t)},this.play_file=function(t){var e=t.video_id,n=t.m||0;if(n=parseInt(n,10),!e)return!1;if(e!=this.video_id())try{this.youtube_player.loadVideoById(e),i.instance.player.seek_to_m=n,i.instance.player.seek_to_video_id=e}catch(a){}else this.play(),this.seek(n)}},soundcloud:function(t,e){var i=this;return i.instance=e,i.player_id=t,SC&&SC.Widget&&SC.Widget(t)?(i.player_position=0,i.player_state="PAUSED",i.player_video_id=!1,i.player_duration=!1,SC.Widget(i.player_id).bind("playProgress",function(t){i.player_position=t.currentPosition,i.player_state="PLAYING"}),SC.Widget(i.player_id).bind("pause",function(){i.player_state="PAUSED"}),SC.Widget(i.player_id).bind("finish",function(){i.player_state="PAUSED"}),this.play=function(){SC.Widget(i.player_id).play()},this.pause=function(){SC.Widget(i.player_id).pause()},this.play_state=function(){return i.player_state},this.position=function(){return i.player_position},this.duration=function(){return i.player_duration},this.video_id=function(){return i.player_video_id},this.seek=function(t){SC.Widget(i.player_id).seekTo(t)},this.load_meta=function(){SC.Widget(i.player_id).getCurrentSound(function(t){i.player_duration=t.duration,i.player_video_id=t.id}),SC.Widget(i.player_id).get},this.load_meta(),void 0):!1},soundmanager2:function(t,e){var i=this;if(i.instance=e,!(soundManager&&soundManager.soundIDs.indexOf(t)>=0))return!1;var n=soundManager.getSoundById(t);this.play=function(){n.play()},this.pause=function(){n.pause()},this.play_state=function(){return 1==n.playState&&0==n.paused?"PLAYING":"PAUSED"},this.position=function(){return n.position},this.duration=function(){return n.duration},this.video_id=function(){return n.url.split("/").slice(-1)[0]},this.seek=function(t){n.setPosition(t)}},sublime:function(t,e){var i=this;return i.instance=e,"undefined"==typeof sublime||"undefined"==typeof sublime.player?!1:"undefined"==typeof sublime.player(t)?!1:(i.player_id=t,i.player_state=!1,sublime.player(i.player_id).on({start:function(){i.player_state="PLAYING"},end:function(){i.player_state="PAUSED"},timeUpdate:function(){i.player_state="PLAYING"},stop:function(){i.player_state="PAUSED"},pause:function(){i.player_state="PAUSED"},play:function(){i.player_state="PLAYING"}}),this.play=function(){sublime.player(i.player_id).play()},this.pause=function(){sublime.player(i.player_id).pause()},this.play_state=function(){return i.player_state},this.position=function(){return 1e3*sublime.player(i.player_id).playbackTime()},this.duration=function(){return parseInt(1e3*sublime.player(i.player_id).duration(),10)},this.video_id=function(){return!1},void(this.seek=function(t){var e=t/1e3;sublime.player(i.player_id).seekTo(e)}))},html5:function(t,e){var i=this;i.instance=e;var n=P3.JQuery("#"+t);return 0==n.length?!1:("video"!=n.get(0).tagName.toLowerCase()&&(n=P3.JQuery(n).find("video,audio")),this.html5_player=n.get(0),void("undefined"!=typeof this.html5_player&&"undefined"!=typeof this.html5_player.play&&(this.play=function(){this.html5_player.play()},this.pause=function(){this.html5_player.pause()},this.play_state=function(){return this.html5_player.paused?"PAUSED":"PLAYING"},this.position=function(){return parseInt(1e3*this.html5_player.currentTime,10)},this.duration=function(){return parseInt(1e3*this.html5_player.duration,10)},this.video_id=function(){return!1},this.seek=function(t){this.play();var t=parseInt(t,10)/1e3;t=Math.max(0,t-1),this.html5_player.currentTime=t})))}};var p3_ooyala_interfaces={},p3_kaltura_interfaces={};PlayerInterfaceExtension_Kaltura=function(t){var e=this;this.player_interface=t,this.kaltura_player_id=t.kaltura_player.id,this.play_handler=function(){e.player_interface.player_state="PLAYING"},this.pause_handler=function(){e.player_interface.player_state="PAUSED"},this.playhead_handler=function(t){e.player_interface.player_state="PLAYING",e.player_interface.playhead_time=1e3*parseFloat(t)}};var p3_jw_interfaces={};PlayerInterfaceExtension_JW=function(t){var e=this;this.player_interface=t,this.jw_player_id=t.jw_player.id,this.play_handler=function(t){e.player_interface.player_state="PLAYING"==t.newstate?"PLAYING":"PAUSED"},this.playhead_handler=function(t){e.player_interface.playhead_time=1e3*parseFloat(t.position)}};var p3_vimeo_interfaces={};PlayerInterfaceExtension_Vimeo=function(t){var e=this;this.player_interface=t,this.vimeo_player_id=t.vimeo_player.id,this.play_handler=function(){e.player_interface.player_state="PLAYING"},this.pause_handler=function(){e.player_interface.player_state="PAUSED"},this.playhead_handler=function(t){e.player_interface.player_state="PLAYING",e.player_interface.playhead_time=1e3*parseFloat(t)}};var p3_vimeo_iframe_interfaces={};PlayerInterfaceExtension_VimeoIframe=function(t){var e=this;this.player_interface=t,this.vimeo_player_id=t.vimeo_player.id,this.play_handler=function(){e.player_interface.player_state="PLAYING"},this.pause_handler=function(){e.player_interface.player_state="PAUSED"},this.playhead_handler=function(t){e.player_interface.player_state="PLAYING",e.player_interface.playhead_time=1e3*parseFloat(t.seconds)}},P3.Transcript=function(instance,options){var $=P3.JQuery,parent=this;this.instance=instance,this.file={},this.cache_id=parseInt(1e6*Math.random()),this.transcript_cache={},this.stemmer=!1,this.skin_dependencies={hot_pink:"basic_color",blue_pro:"basic_color",cardinal_red:"basic_color",zesty_orange:"basic_color",darth_gecko:"gecko3",sunburst:"basic_textured",wood:"basic_textured",metallic:"basic_textured",ice:"frost"},this.settings={skin:"frost",ie6_skin:"ice",width:"400px",height:"400px",file_id:!1,can_print:!1,can_download:!1,can_clip:!1,can_collapse:!1,collapse_label:"",expand_label:"",vertical_collapse:!1,scan_view:!1,scan_view_buffer:50,collapse_onload:!1,hide_onerror:!1,track_alt:!1,progressive_tracking:!1,track_highlighted_words:!1,track_spoken_words:!0,keyup_search:!1,transcript_search_offset:3e3,transcript_versions:!1,transcript_url:!1,transcript_url_convention:!1,cross_domain_loader:!1,cross_domain_dynamic_callback:!1,search_transcript_stemming:!0,search_strict_mode:!1,search_placeholder:"Search Video",download_format:"txt",transcript_offset:!1,transcript_start:!1,transcript_end:!1,locked:!0,global_unlock:!1,light_scroll:!1,template:"default",tooltips:!0,api_key:!1},this.init=function(){return $.each(options.transcript,function(t){parent.settings[t]=options.transcript[t]}),parent.settings.target?(parent.settings.file_id||(parent.settings.file_id=parent.instance.settings.file_id),parent.settings.api_key||(parent.settings.api_key=P3.Settings.api_key),P3.Util.is_ie6()&&parent.settings.ie6_skin&&(parent.settings.skin=parent.settings.ie6_skin),parent.settings.search_transcript_stemming&&P3.Util.load_remote_script("//p3.3playmedia.com/javascripts/vendor/Snowball.min.js"),this.render(),void this.listen()):!1},this.die=function(){$(this.transcript_container).find("span").die("click"),$(this.transcript_container).die("click"),$(this.container).find("a").die("click"),$(this.container).find(".print").die("click"),$(this.container).find(".download").die("click"),$(this.container).find(".scan-view").die("click"),$(this.container).find(".p3-timeline").die("click"),$(this.container).find(".pointer").die("click"),$(this.container).find(".pointer").die("mouseover"),$(this.container).find(".p3-transcript-button").die("click"),$(this.container).find(".p3-transcript-button").die("mouseover"),$(this.container).children().remove(),parent.instance.event.trigger("Transcript.Die")},this.container=$("#"+options.transcript.target),this.transcript_container={},this.render=function(){var t=parent.templates[parent.settings.template]?parent.settings.template:"default",e=new EJS({text:parent.templates[t],type:"["}).render(parent.settings);$(this.container).html(e),parent.transcript_container=$(this.container).find(".p3-transcript-main"),parent.apply_skin(),P3.Util.is_ie()&&(parent.settings.width=parseInt(parent.settings.width,10)+2+"px",parent.settings.height=parseInt(parent.settings.height,10)+2+"px"),$(this.container).find(".p3-transcript-container").css({width:parent.settings.width,height:parent.settings.height}),$(this.container).find("input[type=text]").each(function(){var t=$(this).val();$(this).attr("oval",t)}),this.resolve_transcript_height(),this.transcript_request(),parent.settings.can_collapse&&parent.settings.collapse_label&&$(parent.container).find(".p3-transcript-button.collapse").addClass("visible-label"),parent.settings.can_collapse&&parent.settings.collapse_onload&&parent.collapse(),parent.instance.event.trigger("Transcript.TemplateRendered")},this.listen=function(){$(this.container).find("input[type=text]").live("click",function(){$(this).val()==$(this).attr("oval")&&$(this).val("")}),$(this.container).find(".p3-transcript-search").live("keyup",function(t){var e=t.keyCode||t.which;27==e&&($(this).val(""),parent.search_transcript("")),parent.settings.keyup_search&&(parent.keyup_search_timeout&&clearTimeout(parent.keyup_search_timeout),parent.keyup_search_timeout=setTimeout(function(){var t=$(parent.container).find(".p3-transcript-search").val();parent.search_transcript(t,"topbar_search")},333))}),$(this.container).find(".p3-transcript-bottom-search-submit").live("click",function(){var t=$(parent.container).find(".p3-transcript-bottom-search").val();parent.search_transcript(t,"bottombar_search")}),$(this.container).find(".p3-transcript-bottom-search").live("keyup",function(t){var e=t.keyCode||t.which;if(27==e)$(this).val(""),parent.search_transcript("");else if(13==e){var i=$(this).val();parent.search_transcript(i,"bottombar_search")}parent.settings.keyup_search&&(parent.keyup_search_timeout&&clearTimeout(parent.keyup_search_timeout),parent.keyup_search_timeout=setTimeout(function(){var t=$(parent.container).find(".p3-transcript-bottom-search").val();parent.search_transcript(t,"bottombar_search")},333))}),$(this.container).find(".p3-transcript-searchform").submit(function(){var t=$(this).find(".p3-transcript-search").val();return parent.search_transcript(t),!1}),$(this.container).find(".p3-transcript-search-reset").live("click",function(){$(parent.container).find(".p3-transcript-search,.p3-transcript-bottom-search").val(""),parent.search_transcript("")}),$(this.container).find(".p3-bottombar-reset-search").live("click",function(){parent.search_transcript(""),$(parent.container).find(".p3-transcript-bottom-search").val("")}),$(this.container).find(".print").live("click",function(){parent.print_transcript()}),$(this.container).find(".download").live("click",function(){location.href=parent.download_url()}),$(this.container).find(".scan-view").live("click",function(){var t=$(this).find("span").html();"Scan View"==t?(parent.load_scan_view(),$(this).find("span").html("Loading")):(parent.clear_scan_view(),$(this).find("span").html("Scan View"))}),$(this.container).find(".p3-timeline,.p3-bottombar-timeline").live("click",function(t){var e=(t.offsetX||t.layerX)/$(this).outerWidth(),i=e*parent.file.duration;parent.instance.player["interface"].seek(i)}),$(this.container).find(".pointer").live("click",function(){var t=parseInt($(this).attr("m"),10)-parent.settings.transcript_search_offset;return parent.instance.player["interface"].seek(t),!1}),$(this.container).find(".pointer").live("mouseover",function(e){for(var next_word=$(parent.transcript_container).find("span[m="+$(this).attr("m")+"]"),msg=[],counter=0;next_word.length>0&&7>counter;)msg.push($(next_word).html()),counter+=1,next_word=$(next_word).next();var re=eval("/("+parent.saved_search_term+")/gi");parent.settings.tooltips&&P3.Util.tooltip(e,msg.join(" ").replace(re,"<b>$1</b>"),parent.settings.skin)}),$(this.container).find(".p3-transcript-button").live("click",function(){$(this).hasClass("locked")?($(this).removeClass("locked"),$(this).addClass("unlocked"),$(this).find("span").html("Lock"),parent.settings.locked=!1,parent.settings.global_unlock=!0):$(this).hasClass("unlocked")&&($(this).removeClass("unlocked"),$(this).addClass("locked"),$(this).find("span").html("Unlock"),parent.settings.locked=!0,parent.settings.global_unlock=!1)}),$(this.container).find(".p3-transcript-button").live("mouseover",function(t){var e=!1,i=$(t.target);switch(!0){case i.hasClass("print"):e="Print Transcript";break;case i.hasClass("download"):e="Download Transcript";break;case i.hasClass("locked"):e="Disable Transcript Auto-Scrolling";break;case i.hasClass("unlocked"):e="Enable Transcript Auto-Scrolling";break;case i.hasClass("collapse"):e="Hide Interactive Transcript";break;case i.hasClass("expand"):e="View Interactive Transcript";break;case i.hasClass("clip-inactive"):e="Highlight Text to Share Clips";break;case i.hasClass("clip-active"):e="Share Highlighted Clip"}0!=e&&parent.settings.tooltips&&P3.Util.tooltip(t,e)}),$(this.transcript_container).live("click",function(t){var e=t.target;if(P3.JQuery.inArray(e.tagName.toLowerCase(),["b","i","u"])>=0&&(e=$(e).parents("span:first").get(0)),!e||"span"!=e.tagName.toLowerCase())return!1;var i=$(e).attr("m"),n=$(e).html();parent.instance.event.trigger("Transcript.WordClick",{m:i,word:n,current_m:parent.instance.player["interface"].position()}),parent.instance.player["interface"].seek(i)}),$(this.transcript_container).mouseover(function(){parent.settings.locked=!1}),$(this.transcript_container).mouseout(function(){parent.settings.locked=!0}),$(this.transcript_container).mousedown(function(){parent.settings.can_clip&&$(parent.container).find(".clip-active").removeClass("clip-active").addClass("clip-inactive")}),$(this.transcript_container).mouseup(function(){parent.handle_selected_text()}),$(this.container).find(".collapse").live("click",function(){parent.collapse()}),$(this.container).find(".expand").live("click",function(){parent.expand()}),$(this.container).find(".p3-transcript-versions").change(function(){var t=$(this).val().replace(/^\s+|\s+$/,"");parent.settings.transcript_url=t,parent.transcript_request()}),$(this.container).find(".p3-close-social-sharing").live("click",function(){return $(parent.container).find(".p3-social-sharing").remove(),!1}),$(this.container).find(".clip-active").live("click",function(t){parent.start_clip_share(t)}),$(this.container).find(".p3-tweet-clip").live("click",function(t){parent.tweet_clip(parent.settings.current_clip_selection,t)}),$(this.container).find(".p3-facebook-clip").live("click",function(t){parent.facebook_clip(parent.settings.current_clip_selection,t)}),$(this.container).find(".p3-get-shortened-link").live("click",function(t){parent.get_shortened_link(parent.settings.current_clip_selection,t)})},this.collapse=function(){var t=$(this.container).find(".collapse");t.addClass("expand"),t.removeClass("collapse"),parent.settings.expand_label&&t.find("span").html(parent.settings.expand_label),$(parent.container).find(".p3-transcript-main, .p3-transcript-controller, .p3-transcript-mediabar").hide();var e=$(parent.container).find(".p3-transcript-container").height();$(parent.container).find(".p3-transcript-container").attr("cache-height",e),$(parent.container).find(".p3-transcript-container").css("height","auto"),$(parent.container).find(".scan-view").hide(),parent.instance.event.trigger("Transcript.Collapse")},this.expand=function(){var t=$(this.container).find(".expand");t.removeClass("expand"),t.addClass("collapse"),parent.settings.collapse_label&&t.find("span").html(parent.settings.collapse_label),$(parent.container).find(".p3-transcript-main, .p3-transcript-controller, .p3-transcript-mediabar").show(),$(parent.container).find(".p3-transcript-container").css("height",$(this).attr("cache-height")),$(parent.container).find(".scan-view").show(),parent.instance.event.trigger("Transcript.Expand")},this.apply_skin=function(t){if(t=t||parent.settings.skin,t=parent.skin_dependencies[t]?parent.skin_dependencies[t]+" "+t:t){var e=$(this.container).find(".p3-transcript-container"),i=e.attr("class").split(/\s+/);$.each(i,function(t){var n=i[t];"p3-transcript-container"!=n&&e.removeClass(n)}),e.addClass(t),setTimeout(function(){parent.resolve_transcript_height()},10),setTimeout(function(){parent.resolve_transcript_height()},50),setTimeout(function(){parent.resolve_transcript_height()},100),setTimeout(function(){parent.resolve_transcript_height()},250),setTimeout(function(){parent.resolve_transcript_height()},500),setTimeout(function(){parent.resolve_transcript_height()},1e3)}parent.settings.skin=t},this.resolve_transcript_height=function(){var t=$(this.container).find(".p3-transcript-container").outerHeight();t-=$(this.container).find(".p3-transcript-mediabar").outerHeight(),t-=$(this.container).find(".p3-transcript-controller").outerHeight(),t-=$(this.container).find(".p3-transcript-bottombar").outerHeight(),t-=2,$(this.transcript_container).css("height",t+"px")},this.transcript_request=function(){return parent.instance.settings.platform_integration&&this.settings.transcript_url_convention&&(this.settings.transcript_url=this.settings.transcript_url_convention.replace("{file_id}",this.settings.file_id)),this.settings.transcript_url?this.load_remote_transcript():this.load_static_transcript()},this.load_static_transcript=function(){P3.Util.load_remote_script(this.transcript_static_url())},this.load_scan_view=function(){P3.Util.load_remote_script(this.keywords_url())},this.timing_info=function(){for(var t=["transcript_offset","transcript_start","transcript_end"],e=[],i=0;i<t.length;i++)parent.settings[t[i]]&&/^\-*\d+$/.test(parent.settings[t[i]])&&e.push("&"+t[i].replace("transcript_","")+"="+parent.settings[t[i]]);return e.join("")},this.transcript_static_url=function(){for(var t={callback:"P3.instances["+parent.instance.instance_index+"].transcript.parse_transcript_data"},e=["transcript_offset","transcript_start","transcript_end"],i=0;i<e.length;i++)parent.settings[e[i]]&&/^\-*\d+$/.test(parent.settings[e[i]])&&(t[e[i].replace("transcript_","")]=parent.settings[e[i]]);return this.api_request("files/{id}/transcript","tpm",t)},this.load_remote_transcript=function(url){url=url||this.settings.transcript_url,parent.settings.cross_domain_loader?(parent.settings.cross_domain_dynamic_callback&&(url+=/\?/.test(url)?"&":"?",url+="callback=P3.instances["+parent.instance.instance_index+"].transcript.parse_transcript_data"),P3.Util.load_remote_script(url)):$.getJSON(url,function(obj){parent.parse_transcript_data(eval(obj))})},this.api_request=function(t,e,n){var a=P3.Settings.static_host;t&&(a+="/"+t.replace("{id}",parent.settings.file_id)),a+="."+(e||"js"),arr=[],n.apikey=parent.settings.api_key,n.usevideoid=parent.instance.settings.platform_integration?1:0;for(i in n)arr.push(i+"="+encodeURIComponent(n[i]));return a+="?"+arr.join("&")},this.download_url=function(){return fmt=parent.settings.download_format.toLowerCase(),pathway="srt"==fmt?"captions":"transcript",this.api_request("files/{id}/"+pathway,fmt,{dl:1})},this.keywords_url=function(){return this.api_request("files/{id}/keywords","js",{callback:"P3.instances["+parent.instance.instance_index+"].transcript.parse_scan_view_data"})},this.parse_transcript_data=function(t){try{if(t.errors||t.is_error)return parent.transcript_load_error(t);$(this.transcript_container).html(t.transcript),parent.settings.first_word=!1,this.file=t.file,this.transcript_cache={};var e=$(this.transcript_container).find("p");$.each(e,function(t){var i=$(e[t]).find("span:first"),n=parseInt($(i).attr("m"),10);return isNaN(n)?!0:(parent.transcript_cache[n]=[],void $.each($(e[t]).find("span"),function(){var t=parseInt($(this).attr("m"),10);parent.transcript_cache[n].push(t),$(this).attr("id",parent.paragraph_word_cache_key(n,t))}))}),parent.settings.hide_onerror&&$(parent.container).show(),parent.clear_searched_transcript(),parent.clear_scan_view(),parent.instance.event.trigger("Transcript.Ready")}catch(i){parent.transcript_load_error(!1)}},this.transcript_load_error=function(t){parent.settings.hide_onerror&&$(parent.container).hide(),$(parent.transcript_container).html("<p>There was an error loading the transcript.</p>"),t&&(t.errors||t.is_error)&&$(parent.transcript_container).append("<p>The requested transcript was not found.</p>"),parent.instance.event.trigger("Transcript.LoadError")},this.parse_scan_view_data=function(obj){var keyvals={},re_arr=[],space_repl="(\\<[^\\>]*?\\>)*\\s*(\\<[^\\>]*?\\>)*\\s*",dostem="undefined"!=typeof Snowball;$.each(obj,function(t){var e=obj[t][0].replace(/^\s+|\s+$/,"");if(restr=e.replace(/\s+/g,space_repl),dostem){parent.stemmer=parent.stemmer||new Snowball("English");var i=e.split(/\s+/),n=[];for(j=0;j<i.length;j++){parent.stemmer.setCurrent(i[j]),parent.stemmer.stem();var a=parent.stemmer.getCurrent();n.push(a)}sstr=n.join(space_repl),keyvals[n.join(" ")]=obj[t][1],sstr!=restr&&(restr+="|"+sstr)}/\s/.test(e)?re_arr.unshift(restr):re_arr.push(restr),keyvals[e.toLowerCase()]=obj[t][1]});var bigre=eval('/<span[^>]+m="([^"]+?)"[^>]*>('+re_arr.join("|")+")[\b.!?)\"']*</gi"),matches={},tre=/\<[^\>]*\>/g,key=parent.cache_id;$(parent.transcript_container).find("p").each(function(){matches={};var t=$(this).html(),e=$(this).find("span:first").attr("m");t.replace(bigre,function(t,i,n){var a=n.replace(tre," ").replace(/\s+/g," ");matches[key+"_"+e+"_"+i]={s:a,v:keyvals[a.toLowerCase()]}});for(m in matches)for(var i=$(this).find("#"+m),n=matches[m].s.split(/\s+/).length,a=0;n>a;a++)i.css("font-size",matches[m].v+"%"),i.addClass("p3-keyword"),i=i.next()}),$(parent.container).find(".scan-view span").html("Normal View")},this.clear_scan_view=function(){if(!parent.settings.scan_view)return!1;var t=$(parent.transcript_container).find(".p3-keyword");t.css("font-size",""),t.removeClass("p3-keyword"),$(parent.container).find(".scan-view span").html("Scan View")},this.paragraph_word_cache_key=function(t,e){return parent.cache_id+"_"+t+"_"+e},this.last_word=function(){var t=this.transcript_cache.length-1,e=this.transcript_cache[t].length-1;return this.paragraph_word_cache_key(t,e)},this.track=function(t){if(!parent.settings.track_spoken_words)return!1;if(!parent.transcript_cache)return!1;$(this.container).find(".p3-timeline-progress").css({width:Math.min(100,100*(t/parent.file.duration))+"%"});var e=!1,i=!1;if($.each(parent.transcript_cache,function(e){return i||(i=e),e>t?!1:void(i=e)}),$.each(parent.transcript_cache[i],function(n){if(parent.transcript_cache[i][n]>=t){var a=parent.transcript_cache[i][n];return e=$("#"+parent.paragraph_word_cache_key(i,a)),parent.settings.track_alt&&e.prev().length>0&&(e=e.prev()),!1}}),!e){var n=parent.transcript_cache[i].slice(-1);e=$("#"+parent.paragraph_word_cache_key(i,n))}return parent.track_to_word(e,i),this.settings.locked!==!0?!1:this.settings.global_unlock===!0?!1:void parent.scroll_to_word(parent.current_word)},this.track_to_word=function(t,e){if(parent.current_word==t)return!1;if(parent.settings.progressive_tracking){if(parent.current_paragraph!=e){$(parent.container).find(".tracked_paragraph").removeClass("tracked_paragraph"),$(parent.container).find(".current_paragraph").removeClass("current_paragraph");
var i=$(t).parents("p:first").prevAll();$(i).addClass("tracked_paragraph"),$(t).parents("p:first").addClass("current_paragraph");var n=$(t).parents("p:first").nextAll();$(n).removeClass("tracked_paragraph")}$(t).nextAll().removeClass("tracked_word"),$(t).prevAll().addClass("tracked_word"),$(t).addClass("tracked_word")}else $(parent.current_word).removeClass("current_word"),$(t).addClass("current_word");parent.settings.track_highlighted_words&&parent.instance.event.trigger("Transcript.HighlightedWord",{m:$(t).attr("m"),word:$(t).html()}),parent.current_paragraph=e,parent.current_word=t},this.scroll_to_word=function(t){if(!parent.settings.locked)return!1;parent.settings.first_word=parent.settings.first_word||this.transcript_container.find("span[m]:first");var e=this.transcript_container.scrollTop(),i=parseInt($(t).offset().top-$(parent.settings.first_word).offset().top,10),n=parseInt(e,10);if(parent.settings.light_scroll){var a=$(parent.transcript_container).height();(i-e>.75*a||0>i-e)&&this.transcript_container.scrollTop(i)}else i!=n&&this.transcript_container.scrollTop(i)},this.clear_searched_transcript=function(){$(parent.container).find(".p3-transcript-search-reset").hide(),$(parent.transcript_container).find(".search_hit").removeClass("search_hit"),$(parent.container).find(".pointer").remove(),$(".p3-tooltip").remove(),$(parent.container).find(".p3-bottombar-timeline-container").hide(),$(parent.container).find(".p3-transcript-bottombar-logo").show(),parent.instance.event.trigger("Transcript.ResetSearch",{})},this.search_transcript=function(searchterm,callback){parent.clear_searched_transcript(),callback=callback||"topbar_search",searchterm=searchterm.replace(/\"([^\s\"]+?)\"$/g,"$1");var is_phrase=/\".+\"/;is_phrase.test(searchterm)||(searchterm=searchterm.replace(/\"/g,""));var sanitized_arr=searchterm.replace(/^\s+|\s+$/g,"").split(/\s+/);if(parent.saved_search_term=sanitized_arr.join("|"),""==sanitized_arr.join(""))return!1;if(!parent.settings.search_transcript_stemming||parent.settings.search_strict_mode||"undefined"==typeof Snowball||is_phrase.test(searchterm)||(parent.stemmer=parent.stemmer||new Snowball("English"),$.each(sanitized_arr,function(t,e){parent.stemmer.setCurrent(e),parent.stemmer.stem();var i=parent.stemmer.getCurrent();P3.Util.in_array(i,sanitized_arr)||sanitized_arr.push(i)})),$(parent.container).find(".p3-transcript-search-reset").show(),is_phrase.test(searchterm))matches=this.phrase_search_matches(sanitized_arr);else{var sanitized=sanitized_arr.join("|"),b=parent.settings.search_strict_mode?"\\b":"",re=eval("/("+sanitized+")"+b+"/i"),matches=[];$(parent.transcript_container).find("span").each(function(){re.test($(this).html())&&($(this).addClass("search_hit"),matches.push(parseInt($(this).attr("m"),10)))})}callback&&parent[callback](matches),parent.instance.event.trigger("Transcript.Search",{searchterm:searchterm,matches:matches})},this.phrase_search_matches=function(sanitized_arr){var search_phrases=[],quoted=!1,open_quote=/^\"/,close_quote=/\"$/;phrasewords=[],$(sanitized_arr).each(function(t,e){quoted?close_quote.test(e)?(quoted=!1,e=e.replace(/\"$/,""),phrasewords.push(e),search_phrases.push(phrasewords.join(" ")),phrasewords=[]):phrasewords.push(e):open_quote.test(e)?(quoted=!0,e=e.replace(/^\"/,""),phrasewords=[e]):search_phrases.push(e)}),matches=[];var m_finder=/m\=\"(\d+)\"/gi;return $(search_phrases).each(function(i,phrase){phrase=phrase.replace(/\b/g,"(<[^>]+>|s+)*");var re=eval("/("+phrase+")/gi");$(parent.transcript_container).html().replace(re,function(t){t.replace(m_finder,function(){var t=parseInt(arguments[1],10);matches.push(t),$(parent.transcript_container).find("span[m="+t+"]").addClass("search_hit")})})}),matches},this.topbar_search=function(t){$(parent.container).find(".p3-timeline").css("position","relative");$(parent.container).find(".p3-timeline").outerHeight();$.each(t,function(e){var i=t[e],n=parseInt(100*(i/parent.file.duration))+"%",a=$("<span></span>");$(a).attr("m",i),$(a).addClass("pointer"),$(a).html("&nbsp;"),$(a).css({position:"absolute",top:0,bottom:0,width:"2px",zIndex:2e3,left:n}),$(parent.container).find(".p3-timeline").append(a)})},this.bottombar_search=function(t){var e=t.length>=100?"99+":t.length;$(parent.container).find(".p3-bottombar-timeline-hits").html(e+" results");var i=$(parent.container).find(".p3-bottombar-timeline-container");$(i).show(),$(parent.container).find(".p3-transcript-bottombar-logo").hide();var n=$(parent.container).find(".p3-bottombar-timeline");$(n).show(),$(i).css("width","120px"),$(n).css("width","120px"),$.each(t,function(e){var i=t[e],a=parseInt(100*(i/parent.file.duration))+"%",r=$("<span></span>");$(r).attr("m",i),$(r).addClass("pointer"),$(r).html("&nbsp;"),$(r).css({position:"absolute",top:4,bottom:4,width:"2px",zIndex:2e3,left:a}),$(n).append(r)}),t.length<=50?$(i).animate({width:"245px"},200):$(i).css({width:"245px"})},this.print_transcript=function(){var t=$(parent.transcript_container).html();t=t.replace(/\<span[^\>]*?\>/,""),P3.Util.print(t,!0)},this.handle_selected_text=function(){var t=P3.Util.selected_html();if(!t)return!1;var e=$("<p></p>");e.append(t);var i=e.find("span:first"),n=e.find("span:last"),a=parseInt($(i).attr("m"),10),r=parseInt($(n).attr("m"),10),s=/^\s+|\s+$/,o=[];if($(e).find("span").each(function(){var t=$(this).html().replace(s,"");o.push(t)}),o=o.join(" "),shortened_text=o.length>100?(o.slice(0,40)+" [...] "+o.slice(-40)).replace(/\s+/," "):o,!a)return!1;if(!r)return!1;if(a==r)return!1;if(!o)return!1;var p={start_ms:a,end_ms:r,duration:r-a,raw_text:o,shortened_text:shortened_text};parent.instance.event.trigger("Transcript.Selection",p)},this.get_shortened_link=function(t,e){url=t.url||location.href,context=t.shortened_text||"",P3.Util.shorten_url(url,context,function(t){$(e.target).html(t),$(e.target).css("text-transform","none"),$(e.target).die("click"),$(e.target).click(function(){window.open(t)})})},this.start_clip_share=function(){if($(parent.container).find(".p3-social-sharing").length>0)return $(parent.container).find(".p3-social-sharing").remove(),!1;var t=parent.settings.current_clip_selection,e=new EJS({text:parent.social,type:"["}).render(t);$(parent.container).find(".p3-transcript-container").css("position","relative"),$(parent.container).find(".p3-transcript-container").append(e);var i=$(parent.container).find(".p3-social-sharing"),n=$(parent.container).find(".clip-active"),a=$(parent.container).find(".p3-transcript-container"),r=n.offset().top+n.outerHeight()-a.offset().top+"px",s=n.offset().left-a.offset().left,o=a.outerWidth()-i.outerWidth();s=Math.min(s,o)+"px",$(i).css({top:r,left:s})},this.tweet_clip=function(t){url=t.url||location.href,context=t.shortened_text||"",P3.Util.shorten_url(url,context,function(t,e){e=e?' "'+e+'"':"";var i="Video Bookmark "+t+e+" #3playmedia",n="http://twitter.com/?status="+encodeURIComponent(i);window.open(n)})},this.facebook_clip=function(t){url=t.url||location.href,context=t.shortened_text||"",context=context?' "'+context+'"':"";var e="http://www.facebook.com/share.php?u="+encodeURIComponent(location.href);e+="&t="+encodeURIComponent("Video Bookmark"),window.open(e)},$(instance).bind("Transcript.Selection",function(t,e){if(parent.settings.can_clip){$(parent.container).find(".clip-inactive").removeClass("clip-inactive").addClass("clip-active");var i=location.href.replace(/\#.+?$/,"");i+="#p3s:"+e.start_ms+"&p3e:"+e.end_ms,i+=P3.instances.length>1?"&p3i:"+parent.instance.instance_index:"",location.href=i,e.url=i,parent.settings.current_clip_selection=e}}),$(instance).bind("Player.Progress",function(t,e){return parent.instance.player&&parent.instance.player["interface"]&&parent.instance.player["interface"].play?e.video_id&&e.video_id!=parent.settings.file_id?(parent.settings.file_id=e.video_id,parent.instance.settings.file_id=e.video_id,parent.transcript_request(),!1):void parent.track(e.m):!1}),$(instance).bind("Player.VideoLoad",function(t,e){parent.instance.settings.file_id=e.video_id,parent.settings.file_id=e.video_id,parent.transcript_request()}),$(instance).bind("Transcript.Ready",function(){if(P3.Util.params("p3ts")&&!parent.settings.onload_transcript_search_handled){var t=unescape(P3.Util.params("p3ts"));$(parent.container).find(".p3-transcript-search").val(t),parent.search_transcript(t,"topbar_search"),parent.settings.onload_transcript_search_handled=!1}}),parent.instance.event.trigger("Transcript.TemplateRendered"),this.social='<div start_ms="[%=start_ms%]" end_ms="[%=end_ms%]" url="[%=url%]" class="p3-social-sharing">    <table cellSpacing=0>      <thead>        <tr>          <th>Share @ [%=P3.Util.ms_to_stamp(start_ms)%]-[%=P3.Util.ms_to_stamp(end_ms)%]</th>          <th style="text-align:right;">            <a class="p3-close-social-sharing" href=javascript:void(0);>x</a>          </th>        </tr>      </thead>      <tbody>        <tr>          <td colspan="2" class="p3-clip-text">"[%= shortened_text %]"</td>        </tr>        <tr>          <td colspan=2><a class="p3-tweet-clip" href="javascript:void(0);">Share on Twitter</a></td>        </tr>        <tr>          <td colspan=2><a class="p3-facebook-clip" href="javascript:void(0);">Share on Facebook</a></td>        </tr>        <tr>          <td colspan=2><a class="p3-get-shortened-link" href="javascript:void(0);">Get Shortened Link</a></td>        </tr>      </tbody>    </table>  </div>',this.templates={},this.templates.transcript_only='<div class="p3-container p3-transcript-container">    <div class="p3-transcript-main"><p>Loading Transcript...</p></div>  </div>',this.templates.bottom_search='<div class="p3-container p3-transcript-container">    <div class="p3-transcript-main"><p>Loading Transcript...</p></div>    <div class="p3-transcript-bottombar">      <div class="p3-transcript-bottombar-logo">&nbsp;</div>      <div class="p3-transcript-bottombar-content">      <input type="text" placeholder="[%=search_placeholder%]" class="p3-transcript-bottom-search"/>      <button class="p3-transcript-bottom-search-submit"></button>      <div class="p3-bottombar-timeline-container">        <div class="p3-bottombar-timeline-hits">3 results</div>        <div class="p3-bottombar-timeline"></div>        <div class="p3-bottombar-reset-search">&nbsp;</div>    </div>  </div>',this.templates["default"]='<div class="p3-container p3-transcript-container">    <div class="p3-transcript-mediabar">      <div class="p3-timeline">        <div class="p3-timeline-progress">&nbsp;</div>      </div>    </div>    <div class="p3-transcript-controller">      <form class="p3-transcript-searchform" action="javascript:void(0); return false;">        <div class="p3-transcript-search-inputs">          [%= P3.Util.nice_searchbox({classname:"p3-transcript-search",placeholder:search_placeholder}) %]          <button class="p3-transcript-search-submit"></button>          <div class="p3-transcript-search-reset">&nbsp;</div>        </div>      </form>      <div class="p3-transcript-buttons">        [% if (can_clip) { %]        <a class="p3-transcript-button clip-inactive" href=javascript:void(0);><span>Clip</span></a>        [% } %]        [% if (can_print) { %]        <a class="p3-transcript-button print" href=javascript:void(0);><span>Print</span></a>        [% } if (can_download) { %]        <a class="p3-transcript-button download" href=javascript:void(0);><span>Download</span></a>        [% } %]        [% if ((!global_unlock) && locked != "never") { %]        <a class="p3-transcript-button locked" href=javascript:void(0);><span>Unlock</span></a>        [% } %]      </div>    </div>    <div class="p3-transcript-main"><p>Loading Transcript...</p></div>    <div class="p3-transcript-bottombar">      <div class="p3-transcript-bottombar-logo">&nbsp;</div>      <div class="p3-transcript-bottombar-content">      [% if (can_collapse) { %]      <a href="javascript:void(0);" class="p3-transcript-button collapse"><span>[%=collapse_label%]</span></a>      [% } %]      [% if (scan_view) { %]        <a href="javascript:void(0);" class="scan-view"><span>Scan View</span></a>      [% } %]      [% if (transcript_versions) { %]        <select class="p3-transcript-versions">          [% for (i in transcript_versions) { %]            <option value="[%= transcript_versions[i] %]">[%= i %]</option>          [% } %]        </select>      [% } %]      </div>    </div>  </div>',this.init()},P3.Captions=function(instance,options){var $=P3.JQuery,parent=this;this.instance=instance,this.initialized=!1,this.cached_duration=!1,this.minimized_fade_out_timer=!1,this.settings={api_key:!1,skin:!1,file_id:!1,srt_url:!1,srt_url_convention:!1,overlay:!1,overlay_draggable:!1,overlay_offset_x:!1,overlay_offset_y:!1,overlay_minimized_offset_x:!1,overlay_minimized_offset_y:!1,minimize_onload:!1,tracks:!1,cross_domain_loader:!0,cross_domain_dynamic_callback:!0,hide_onerror:!1,menubar:!0,menu_header:!1,searchbar:!0,toggler_enabled:!1,toggler_show_text:"<span>Show Closed Captions</span>",toggler_hide_text:"<span>Hide Closed Captions</span>",toggler_hide_onload:!1,captions_offset:!1,captions_start:!1,captions_end:!1,width:"280px",height:"40px",floater_position:"auto"},this.frames=!1,this.init=function(){return this.initialized?!0:($.each(options.captions,function(t){parent.settings[t]=options.captions[t]}),parent.settings.height="40px",parent.settings.file_id||(parent.settings.file_id=parent.instance.settings.file_id),parent.settings.api_key||(parent.settings.api_key=P3.Settings.api_key),this.render(),this.listen(),void(this.initialized=!0))},this.die=function(){$(this.container).remove()},this.duration=function(){return this.cached_duration?this.cached_duration:(this.cached_duration=parent.instance.player["interface"].duration(),this.cached_duration)},this.container=!1,this.render=function(){($.browser.msie&&parseFloat($.browser.version)<8||P3.Util.is_ipad())&&(this.settings.overlay=!1,this.settings.minimize_onload=!1,this.settings.width=$(parent.instance.player.player).outerWidth(),this.settings.fallback_skin!==!1&&(this.settings.skin=this.settings.fallback_skin));var t=new EJS({text:parent.template,type:"["}).render(parent.settings),e=$(t);if(this.settings.overlay?($(document.body).append(e),parent.container=e,$(parent.instance.player.player).attr("wmode","opaque"),$(e).addClass("overlay"),this.settings.overlay_draggable&&$(e).draggable({handle:":not(.p3-captions-maximizer,.p3-captions-maximizer-arrow,.p3-captions-maximizer-cc)",drag:function(){parent.cache_overlay_position(),parent.remove_floater()}}),$(e).hide(),setTimeout(function(){$(e).show(),parent.position_overlay(),parent.settings.minimize_onload&&(parent.minimize(-1),parent.minimized_fade_out())},1)):(parent.settings.target?$("#"+parent.settings.target).html(e):$(parent.instance.player.player).after(e),parent.container=e,$(e).css({position:"static",display:"block",clear:"both"})),this.settings.width&&$(e).css("width",parseInt(this.settings.width,10)),$(e).attr("owidth",$(e).width()),this.apply_skin(),this.initialize_captions(),this.adjust_components(),this.settings.minimize_onload&&this.settings.overlay||(setTimeout(function(){parent.adjust_components()},10),setTimeout(function(){parent.adjust_components()},50),setTimeout(function(){parent.adjust_components()},100),setTimeout(function(){parent.adjust_components()},250),setTimeout(function(){parent.adjust_components()},500)),this.settings.toggler_enabled){var t=new EJS({text:parent.toggler_template,type:"["}).render(parent.settings),i=$("<div class='p3-captions-toggler-container'></div>");$(i).html(t),this.settings.toggler_target?$(this.settings.toggler_target).html(i):$(e).after(i),$(i).find("a").attr("instance_index",parent.instance.instance_index)}this.settings.toggler_hide_onload&&$(e).hide(),parent.instance.event.trigger("Captions.TemplateRendered")},this.render_floater=function(t){this.remove_floater();var e=new EJS({text:t,type:"["}).render(parent.settings),i=$("<div class='p3-captions-floater'>"+e+"</div>");$(document.body).append(i),$(i).addClass(parent.settings.skin);var n=Math.max(0,$(parent.container).offset().top+.5*($(parent.container).outerHeight()-$(i).outerHeight())),a=$(parent.container).offset().left+$(parent.container).outerWidth();$(i).css({top:n,left:a});var r=P3.Util.window_dimensions().width;if(r<$(i).offset().left+$(i).outerWidth()||"bottom"==parent.settings.floater_position){var n=Math.max(0,$(parent.container).offset().top+$(parent.container).outerHeight()),a=$(parent.container).offset().left+$(parent.container).outerWidth()-$(i).outerWidth();$(i).addClass("no-pointer"),$(i).css({top:n,left:a})}if("top"==parent.settings.floater_position){var n=Math.max(0,$(parent.container).offset().top-$(i).outerHeight()),a=$(parent.container).offset().left+$(parent.container).outerWidth()-$(i).outerWidth();$(i).addClass("no-pointer"),$(i).css({top:n,left:a})}},this.remove_floater=function(){$(".p3-captions-widget").find(".active").removeClass("active"),$(".p3-captions-floater").remove()},this.hide_components=function(){return!1},this.listen=function(){$(document).click(function(t){var e=t.target;0!=$(e).parents(".p3-captions-floater").length||$(e).hasClass("p3-captions-floater")||0!=$(e).parents(".p3-container").length||parent.remove_floater()}),$(parent.container).find(".p3-captions-minimizer").click(function(){parent.minimize()}),$(parent.container).find(".p3-captions-maximizer").click(function(){parent.maximize()}),$(".p3-captions-toggler-container a[instance_index="+parent.instance.instance_index+"]").click(function(){var t=parseInt($(this).attr("instance_index"),10);return"hidden"==$(this).attr("state")?($(this).attr("state","visible"),$(this).html(parent.settings.toggler_hide_text),P3.get(t).captions.container.show(),P3.get(t).captions.adjust_components()):($(this).attr("state","hidden"),$(this).html(parent.settings.toggler_show_text),P3.get(t).captions.container.hide()),!1}),$(this.container).find(".p3-captions-search").click(function(){return $(this).hasClass("active")?parent.remove_floater():($(".p3-captions-widget").find(".active").removeClass("active"),parent.render_floater(parent.search_box),$(this).addClass("active"),P3.Util.is_ios()||$(".p3-captions-floater").find(".p3-captions-searchterm").focus(),$(".p3-captions-floater").find(".p3-captions-searchterm").unbind("keyup"),$(".p3-captions-floater").find(".p3-captions-searchterm").keyup(function(){clearTimeout(parent.settings.search_timeout);var t=this,e=$.browser.msie?500:250;parent.settings.search_timeout=setTimeout(function(){parent.search_captions($(t).val()),$(".p3-captions-searchresult").click(function(){"PLAYING"!=parent.instance.player["interface"].play_state()&&parent.instance.player["interface"].play(),parent.instance.player["interface"].seek(parseInt($(this).attr("ms"),10))}),$(".p3-captions-searchresult:first").addClass("first"),$(".p3-captions-searchresult:last").addClass("last")},e)})),!1}),$(this.container).find(".p3-captions-menu").click(function(){return $(this).hasClass("active")?parent.remove_floater():($(".p3-captions-widget").find(".active").removeClass("active"),parent.render_floater(parent.menu_box),$(this).addClass("active"),$(".p3-captions-floater").find(".p3-caption-track").each(function(){return parent.settings.current_track&&$(this).html()==parent.settings.current_track?($(this).addClass("selected"),!1):void 0}),$(".p3-captions-floater").find(".p3-caption-track").click(function(){$(this).siblings().removeClass("selected"),$(this).addClass("selected"),parent.load_track($(this).html())}),$(".p3-captions-floater").find("li:first").addClass("first"),$(".p3-captions-floater").find("li:last").addClass("last")),!1}),parent.settings.overlay&&($(parent.instance.player.player).mouseover(function(){$(parent.container).hasClass("minimized")&&parent.minimized_fade_in()}),$(parent.instance.player.player).parent().mouseover(function(){$(parent.container).hasClass("minimized")&&parent.minimized_fade_in()}),$(parent.instance.player.player).mouseout(function(){$(parent.container).hasClass("minimized")&&parent.minimized_fade_out()}),$(parent.instance.player.player).parent().mouseout(function(){$(parent.container).hasClass("minimized")&&parent.minimized_fade_out()}))},this.apply_skin=function(t){if(t=t||parent.settings.skin,!t)return!1;if(t=/p3\-captions\-skin/.test(t)?t:"p3-captions-skin-"+t){var e=$(this.container),i=e.attr("class").split(/\s+/);$.each(i,function(t){var n=i[t];/p3-captions-skin/i.test(n)&&e.removeClass(n)}),e.addClass(t)}},this.adjust_components=function(){$(this.container).css({width:parseInt(parent.settings.width,10)+"px",height:parseInt(parent.settings.height,10)+"px"}),$(this.container).find(".p3-captions-components").css({width:parseInt(parent.settings.width,10)+"px",height:parseInt(parent.settings.height,10)+"px"}),$(this.container).find(".p3-captions-components").children().css({height:parseInt(parent.settings.height,10)+"px"});var t=$(this.container).find(".p3-captions-frame"),e=t.children(),i=$(this.container).width();$(t).siblings().each(function(){i-=$(this).outerWidth(),i-=parseFloat($(this).css("margin-left")),i-=parseFloat($(this).css("margin-right"))}),P3.Util.is_ie()&&(i-=2),$(t).css("width",i+"px"),$(e).css("width",i+"px");var n=Math.max(0,Math.min(6,($(t).height()-$(e).height())/2));$(e).css("padding-top",n+"px"),$(e).css("padding-bottom",n+"px"),parent.position_overlay()},this.initialize_captions=function(){parent.settings.tracks?$.each(parent.settings.tracks,function(t){return parent.load_track(t),!1}):this.load_captions()},this.load_captions=function(){return parent.instance.settings.platform_integration&&this.settings.srt_url_convention&&(this.settings.srt_url=this.settings.srt_url_convention.replace("{file_id}",this.settings.file_id)),this.settings.srt_url?this.load_external_srt_url():this.load_static_srt_captions()},this.load_external_srt_url=function(t){t=t||this.settings.srt_url,parent.settings.cross_domain_loader?(parent.settings.cross_domain_dynamic_callback&&(t+=/\?/.test(t)?"&":"?",t+="callback=P3.instances["+parent.instance.instance_index+"].captions.parse_captions_data"),P3.Util.load_remote_script(t)):$.get(t,function(t){parent.frames=parent.srt_lines_to_frames(t.split(/[\r\n]+/))})},this.load_static_srt_captions=function(){var t=document.createElement("script");t.src=this.static_srt_url(),t.type="text/javascript",$(parent.container).get(0).appendChild(t)},this.timing_info=function(){for(var t=["captions_offset","captions_start","captions_end"],e=[],i=0;i<t.length;i++)parent.settings[t[i]]&&/^\-*\d+$/.test(parent.settings[t[i]])&&e.push("&"+t[i].replace("captions_","")+"="+parent.settings[t[i]]);return e.join("")},this.static_srt_url=function(){var t=P3.Settings.static_host+"/files/";return t+=parent.instance.settings.file_id,t+="/captions.js?apikey="+this.settings.api_key,t+=parent.timing_info(),t+=parent.instance.settings.platform_integration?"&usevideoid=1":"",t+="&callback=P3.instances["+parent.instance.instance_index+"].captions.parse_captions_data"},this.load_track=function(t){if(!parent.settings.tracks[t])return!1;var e=parent.settings.tracks[t];parent.settings.current_track=t,parent.settings.srt_url=e,parent.load_external_srt_url()},this.parse_captions_data=function(t){try{var e=t.output;parent.frames=parent.srt_lines_to_frames(e.split(/[\r\n]/))}catch(i){return parent.captions_load_error()}try{if(parent.instance.player["interface"]&&parent.instance.player["interface"].play_state&&"PLAYING"!=parent.instance.player["interface"].play_state()){var n=parent.instance.player["interface"].position()||0;parent.track(n)}}catch(i){}parent.settings.hide_onerror&&$(parent.container).show(),parent.instance.event.trigger("Captions.Ready")},this.captions_load_error=function(){parent.settings.hide_onerror&&$(parent.container).hide(),parent.render_line("ERROR: Could not<br/>load captions."),parent.instance.event.trigger("Captions.LoadError")},this.srt_lines_to_frames=function(t){var e=[],i={},n=0,a=/\s*\-\-\>\s*/,r=/^\d+$/;return $.each(t,function(s){var o=t[s].replace(/^\s+|\s+$/,"");switch(!0){case a.test(o):i.lines&&(e.push(i),i={});var p=o.split(a);i.start_ms=P3.Util.stamp_to_ms(p[0]),i.end_ms=P3.Util.stamp_to_ms(p[1]),i.lines=[];break;case r.test(o)&&parseInt(o)==n+1:n+=1;break;case""==o:break;default:i.lines&&i.lines.push(o)}}),i&&i.start_ms&&i.end_ms&&e.push(i),e},this.minimize=function(t){parent.remove_floater(),t=t||150;var e=parent.minimized_position();parent.cache_overlay_position();var i={width:"34px",height:"20px",top:e.top,left:e.left};$(parent.container).addClass("minimized"),$(parent.container).children().hide(),t>0?$(parent.container).animate(i,t,function(){$(parent.container).find(".p3-captions-maximizer").show(),$(parent.container).find(".p3-captions-maximizer").children().show()}):($(parent.container).css(i),$(parent.container).find(".p3-captions-maximizer").show(),$(parent.container).find(".p3-captions-maximizer").children().show())},this.maximize=function(t){t=t||150;var e=parent.overlay_position();clearTimeout(parent.minimized_fade_out_timer),$(parent.container).removeClass("minimized"),$(parent.container).fadeIn(1),$(parent.container).find(".p3-captions-maximizer").hide(),$(parent.container).animate({width:parseInt(parent.settings.width,10)+"px",height:parseInt(parent.settings.height,10)+"px",top:e.top,left:e.left},t,function(){$(parent.container).children().show(),$(parent.container).find(".p3-captions-maximizer").hide(),parent.adjust_components(),setTimeout(function(){parent.adjust_components()},10)})},this.minimized_fade_out=function(){parent.minimized_fade_out_timer=setTimeout(function(){return parent.container.hasClass("minimized")?void $(parent.container).fadeOut(500):!1},3e3)},this.minimized_fade_in=function(t){t=t||500,clearTimeout(parent.minimized_fade_out_timer),$(parent.container).fadeIn(t)},this.cache_overlay_position=function(){var t=$(parent.container).offset();$(parent.container).attr("cache_top",t.top),$(parent.container).attr("cache_left",t.left)},this.position_overlay=function(){if(!parent.settings.overlay)return!1;var t=parent.overlay_position();$(parent.container).css({top:t.top,left:t.left})},this.overlay_position=function(){if("undefined"!=typeof $(parent.container).attr("cache_top")&&"undefined"!=typeof $(parent.container).attr("cache_left"))return{top:$(parent.container).attr("cache_top"),left:$(parent.container).attr("cache_left")};var t=parent.instance.player.player,e=parent.container,i=$(t).offset(),n=$(t).outerWidth(),a=$(t).outerHeight(),r=$(e).outerWidth(),s=$(e).outerHeight(),o=i.top+a-s;o+="number"==typeof parent.settings.overlay_offset_y?parent.settings.overlay_offset_y:0;var p=i.left;return p+="number"==typeof parent.settings.overlay_offset_x?parent.settings.overlay_offset_x:(n-r)/2,{top:o,left:p}},this.minimized_position=function(){var t=parent.instance.player.player,e=$(t).offset(),i=$(t).outerWidth(),n=$(t).outerHeight(),a=e.top+n-34;a+="number"==typeof parent.settings.overlay_minimized_offset_y?parent.settings.overlay_minimized_offset_y:0;var r=e.left+i-40;return r+="number"==typeof parent.settings.overlay_minimized_offset_x?parent.settings.overlay_minimized_offset_x:0,{top:a,left:r}},this.render_line=function(t){var e=/\<br\/*\>/i;return t.length>32&&!e.test(t)&&(t=parent.waterfall(t)),t=t.replace(/^\<br\/*>/,""),t=e.test(t)?t:t+"<br/>&nbsp;",t==$(parent.container).find(".p3-captions-frame-lines").html()?!1:void $(parent.container).find(".p3-captions-frame-lines").html(t)},this.waterfall=function(t){t=t.replace(/^\s+|\s+$/,"");var e=" ";/\s+/.test(t)?arr=t.split(/\s+/):(arr=t.split(""),e="");var i=arr,n=[],a=Math.abs(i.join(" ").length-n.join(" ").length);for(n.push(i.pop());Math.abs(i.join(" ").length-n.join(" ").length)<a;)a=Math.abs(i.join(" ").length-n.join(" ").length),n.unshift(i.pop());return i.join(e)+"<br/>"+n.join(e)},this.track=function(t){if(!parent.frames)return!1;var e=!1,i=!1;$.each(parent.frames,function(n){return t>=parent.frames[n].start_ms&&t<=parent.frames[n].end_ms?(i=parent.frames[n],e=!0,!1):void 0}),e||(i=parent.frames[parent.frames.length-1]);var n=i.lines.join("<br/>"),a={text:n,frame_ms:i.start_ms,current_ms:t};parent.instance.event.trigger("Captions.FrameRendered",a),parent.render_line(n)},this.search_captions=function(str){$(".p3-captions-searchresults").html("<div class='p3-captions-searchresult-info'>No matches found</div>");var scrubbed=str.replace(/^\s+|\s+$/,"").replace(/\s+/,"|");if(!scrubbed)return!1;$(".p3-captions-searchresults").html("");var re=eval("/("+scrubbed.replace(/^\s+|\s+$/).replace(/\s+/,"|")+")/i"),re_g=eval("/("+scrubbed.replace(/^\s+|\s+$/).replace(/\s+/,"|")+")/ig"),matches=0,last_ms=parent.frames[parent.frames.length-1].start_ms;if($.each(parent.frames,function(t){var e=parent.frames[t].lines.join(" ");if(re.test(e)){matches++,pct=100*(parent.frames[t].start_ms/last_ms)+"%",e=e.replace(re_g,"<b>$1</b>"),obj={text:e,stamp:P3.Util.ms_to_stamp(parent.frames[t].start_ms),ms:parent.frames[t].start_ms,pct:pct};var i=new EJS({text:parent.search_result,type:"["}).render(obj);$(".p3-captions-searchresults").append(i)}}),0==matches){var result="<div class='p3-captions-searchresult-info'>No matches found</div>";$(".p3-captions-searchresults").append(result)}$(".p3-captions-searchresults").find(".p3-captions-searchresult:first").addClass("first"),$(".p3-captions-searchresults").find(".p3-captions-searchresult:last").addClass("last")},$(instance).bind("Player.Ready",function(){parent.init()}),$(instance).bind("Player.Progress",function(t,e){return e.video_id&&e.video_id!=parent.settings.file_id?(parent.instance.settings.file_id=e.video_id,parent.settings.file_id=e.video_id,parent.load_captions(),!1):void parent.track(e.m)}),$(instance).bind("Player.VideoLoad",function(t,e){parent.instance.settings.file_id=e.video_id,parent.settings.file_id=e.video_id,parent.load_captions()}),this.template='<div class="p3-container p3-captions-widget">    [% if (overlay) { %]      <div class="p3-captions-maximizer">        <div class="p3-captions-maximizer-arrow"></div>        <div class="p3-captions-maximizer-cc">cc</div>      </div>    [% } %]    <div class="p3-captions-components">      [% if (overlay) { %]        <div class="p3-captions-minimizer"><span>x</span></div>      [% } %]      <div class="p3-captions-frame">        <div class="p3-captions-frame-lines">          &nbsp;<br/>          &nbsp;        </div>      </div>      [% if (searchbar == true) { %]        <div class="p3-captions-search"><span></span></div>      [% } %]      [% if (menubar && tracks && typeof tracks == "object") { %]        <div class="p3-captions-menu"><span></span></div>      [% } %]    </div>  </div>',this.toggler_template='<a href=javascript:void(0); state="[%=toggler_hide_onload ? "hidden" : "visible" %]" class="p3-captions-toggler">[%=toggler_hide_onload ? toggler_show_text : toggler_hide_text %]</a>',this.cc_button='<div class="p3-captions-cc-button-container">    <div class="p3-captions-maximizer"></div>    <div class="p3-captions-cc-button">CC</div>  </div>',this.search_box='<div class="p3-captions-search-container">    <div class="p3-captions-searchbox">      [%= P3.Util.nice_searchbox({classname:"p3-captions-searchterm",placeholder:"Search Video"}) %]    </div>    <div class="p3-captions-searchresults">      <div class="p3-captions-searchresult-info">Type to search this video</div>    </div>  </div>',this.search_result='<div class="p3-captions-searchresult" ms="[%= ms %]">    <div class="p3-captions-searchresult-header">      <div class="p3-captions-searchresult-stamp">        [%= stamp %]      </div>      <div class="p3-captions-searchresult-timeline"><div style="width:[%=pct%];" class="p3-captions-searchresult-time-in"></div></div>    </div>    <div class="p3-captions-searchresult-content">      [%= text %]    </div>  </div>',this.menu_box='<div class="p3-captions-menubox">    [%= menu_header ? "<h3>" + menu_header + "</h3>" : "" %]    <ul>      [% for (i in tracks) { %]        <li class="p3-caption-track" url="[%=tracks[i]%]">[%=i%]</li>      [% } %]    </ul>  </div>'},P3.Playlist=function(instance,options){var $=P3.JQuery,parent=this;this.instance=instance,this.searchterm="",this.settings={target:!1,width:"400px",playlist_height:"400px",skin:"",suggested_search_terms:[],onload_function:"all_files",search_box_placeholder:"Search by phrase, name, keyword...",list_sort_by:"id:desc",search_sort_by:"",show_segments:!0,show_thumbnails:!0,show_all_results:!1,per_page:10,project_id:!1,linked_account_id:!1,folder_id:!1,base_url:location.protocol+"//static.3playmedia.com/",api_key:!1},this.container=$("#"+options.playlist.target),this.init=function(){if($.each(options.playlist,function(t){parent.settings[t]=options.playlist[t]}),!parent.settings.target)return!1;if(parent.settings.api_key||(parent.settings.api_key=P3.Settings.api_key),parent.settings.per_page=Math.min(parent.settings.per_page,15),parent.settings.width=parseInt(parent.settings.width.toString().replace("px",""),10),parent.settings.width=Math.min(parent.settings.width,800),parent.settings.playlist_height=parseInt(parent.settings.playlist_height.toString().replace("px",""),10),parent.settings.playlist_height=Math.max(parent.settings.playlist_height,150),this.render(),this.apply_skin(),this.listen(),parent.settings.onload_function)try{eval("parent."+parent.settings.onload_function+"()")
}catch(e){}},this.render=function(){var t=new EJS({text:parent.template,type:"["}).render(parent.settings);$(this.container).html(t),this.collection_container=$(this.container).find(".p3-playlist-container"),$(this.collection_container).css({width:parent.settings.width}),$(this.collection_container).find(".p3-playlist-results").css({height:parent.settings.playlist_height}),$(this.container).find("input[type=text]").each(function(){var t=$(this).val();$(this).attr("oval",t)}),parent.instance.event.trigger("Playlist.TemplateRendered")},this.apply_skin=function(t){if(t=t||parent.settings.skin){var e=$(this.collection_container),i=e.attr("class").split(/\s+/);$.each(i,function(t){var n=i[t];"p3-playlist-container"!=n&&e.removeClass(n)}),e.addClass(t),this.settings.skin=t}parseInt(parent.settings.width.toString().replace("px",""),10)<=250&&$(this.collection_container).addClass("p3-playlist-narrow")},this.listen=function(){$(this.container).find(".p3-playlist-suggested-results").live("mouseover",function(t){msg=$(this).hasClass("drop_up")?"Show Keywords":"Hide Keywords",P3.Util.tooltip(t,msg,parent.settings.skin,".p3-playlist-container")}),$(this.container).find(".p3-playlist-ul li a").live("click",function(){var t=$(this).parents("li:first");return $(t).attr("video_id")==parent.instance.player["interface"].video_id()?!1:($(parent.container).find(".p3-playlist-currently-loading").removeClass("p3-playlist-currently-loading"),$(t).addClass("p3-playlist-currently-loading"),void parent.instance.player.load_video({video_id:$(t).attr("video_id"),m:0}))}),$(this.container).find(".p3-playlist-suggested-search-terms a").live("click",function(){var t=$(this).html();$(parent.container).find(".p3-playlist-searchterm").val(t),parent.search(t)}),$(this.container).find(".p3-playlist-suggested-results").live("click",function(){$(".p3_floating_segment").remove();var t=$(parent.container).find(".p3-playlist-suggested-search-terms");if(1==$(parent.container).find(".p3-playlist-suggested-search-terms:visible").length){var e=t.outerHeight();t.attr("oheight",e),t.slideUp(200),$(this).addClass("drop_up"),$(parent.container).find(".p3-playlist-results").animate({height:"+="+e},200)}else{var e=t.attr("oheight");$(this).removeClass("drop_up"),t.slideDown(200),$(parent.container).find(".p3-playlist-results").animate({height:"-="+e},200)}}),$(this.container).find(".p3-playlist-searchterm").keyup(function(t){27==(t.keyCode||t.which)&&parent.clear_search()}),$(this.container).find(".p3-playlist-search-form").submit(function(){var t=$(parent.container).find(".p3-playlist-searchterm").val();return parent.search(t),!1}),$(this.container).find(".p3-playlist-search-reset").live("click",function(){parent.clear_search()}),$(this.container).find(".p3-playlist-prev-video").live("click",function(){var t=parent.settings.current_page-1;return 0>=t?!1:void("search"==parent.load_method?parent.search(parent.searchterm,t):parent.all_files(!1,t))}),$(this.container).find(".p3-playlist-next-video").live("click",function(){var t=parent.settings.current_page+1;return t>parent.settings.total_pages?!1:void("search"==parent.load_method?parent.search(parent.searchterm,t):parent.all_files(!1,t))});var t=".p3-playlist-segmentmap td";t+=parent.settings.show_all_results?"":".hit",$(this.container).find(t).live("click",function(t){parent.load_segment({num:$(this).attr("num"),segs_per:$(this).attr("segs_per"),video_id:$(this).attr("video_id"),evt:t})}),$(".p3-playlist-close-segment").live("click",function(){$(".p3_floating_segment").remove()}),$(".p3-playlist-play-from").live("click",function(){var t=$(this).attr("video_id"),e=parseInt($(this).attr("m"),10);parent.instance.player["interface"].video_id()==t?(parent.instance.player["interface"].play(),setTimeout(function(){parent.instance.player["interface"].seek(e)},0)):($(".p3-playlist-ul li").removeClass("p3-playlist-currently-loading"),$(".p3-playlist-ul li[video_id="+t+"]").addClass("p3-playlist-currently-loading"),parent.instance.player.load_video({video_id:t,m:e}))}),$(".p3_floating_segment .hit").live("click",function(){$(this).siblings().removeClass("active_hit"),$(this).addClass("active_hit");var t=$(this).attr("ind"),e=$(this).parents(".p3_floating_segment:first"),i=e.find("p.segment_content:visible:eq("+t+")").offset().top-e.find("p.segment_content:visible:eq(0)").offset().top;e.find(".floating_segment_content").scrollTop(i)}),$(this.container).find(".p3-playlist-results").scroll(function(){$(".p3_floating_segment").remove()})},this.api_request=function(t,e,n){n=n||"js";var a=parent.settings.base_url;a+="p/projects/"+parent.settings.project_id,t&&(a+="/"+t),a+="."+n,arr=[];for(i in e)arr.push(i+"="+encodeURIComponent(e[i]));a+="?"+arr.join("&"),parent.settings.folder_id&&(a+="&batch_id="+parent.settings.folder_id),P3.Util.load_remote_script(a)},this.all_files=function(t,e){this.load_method="all_files";var i="linked_accounts/"+parent.settings.linked_account_id+"/playlist",n={page:e||1,per_page:parent.settings.per_page||10,sortby:parent.settings.list_sort_by.split(":")[0],desc:/\:desc$/.test(parent.settings.list_sort_by)?"1":"0",callback:"P3.instances["+parent.instance.instance_index+"].playlist.parse_playlist_results"};parent.api_request(i,n)},this.clear_search=function(){$(this.container).find(".p3-playlist-search-reset").hide(),$(this.container).find(".p3-playlist-searchterm").val(""),this.all_files()},this.search=function(t,e){{var e=e||1;parent.settings.per_page||10}if(t=t||"",t=t.replace(/^\s+|\s+$/,""),!t)return"search"==this.load_method&&parent.all_files(),!1;$(parent.container).find(".p3-playlist-search-reset").show(),this.searchterm=t,this.load_method="search";var i="linked_accounts/"+parent.settings.linked_account_id+"/segmentmap",n={page:e||1,query:t,per_page:parent.settings.per_page||10,sortby:parent.settings.search_sort_by,callback:"P3.instances["+parent.instance.instance_index+"].playlist.parse_playlist_results"};parent.api_request(i,n)},this.load_segment=function(t){parent.settings.segment_target_event=t.evt;var e="files/"+t.video_id+"/segments/"+t.num,i={usevideoid:1,segs:t.segs_per,callback:"P3.instances["+parent.instance.instance_index+"].playlist.parse_transcript_segment"};parent.api_request(e,i)},this.parse_transcript_segment=function(obj){$(".p3_floating_segment").remove();var file_id=obj.segments[0].file_id,tr=$(".p3-playlist-container").find("tr[file_id="+file_id+"]"),video_id=$(tr).attr("video_id");obj.video_id=video_id,obj.file_id=file_id;var html=new EJS({text:parent.segment,type:"["}).render(obj),targ=$(tr).parents("table:first"),offset=$(".p3-playlist-container").offset(),width=Math.min(Math.max(250,$(targ).outerWidth()-40),450),height=$(targ).outerHeight(),div=$("<div></div>");if($(div).addClass("p3_floating_segment"),$(div).addClass(parent.settings.skin),$(div).attr("instance_index",parent.instance.instance_index),$(div).html(html),$(document.body).append(div),ll=$(parent.settings.segment_target_event.target).offset().left,ll=ll-$(parent.settings.segment_target_event.target).parents("tbody:first").offset().left-2,ll=Math.max(ll,0),$(".p3-floating-segment-point").css("left",ll),parent.searchterm){var hit_counter=0;$(".p3_floating_segment").find(".segment_content").each(function(){var html=$(this).find("span:last").html();searchterm=parent.searchterm,"undefined"!=typeof Snowball&&(parent.stemmer=parent.stemmer||new Snowball("English"),searchterm=$.map(searchterm.split(/\s+/),function(t){return parent.stemmer.setCurrent(t),parent.stemmer.stem(),parent.stemmer.getCurrent()+"[a-zA-Z]*"}),searchterm.indexOf(parent.searchterm)<0&&searchterm.push(parent.searchterm),searchterm=searchterm.join(" "));var re=eval("/("+searchterm.replace(/[\"]/g,"").replace(/^\s+|\s+$/).replace(/\s+/g,"|")+")/ig");re.test(html)||parent.settings.show_all_results?(html=html.replace(re,"<strong>$1</strong>"),$(this).find("span:last").html(html),$(".paragraph_hits ul").append("<li class='hit "+(0==hit_counter?"active_hit":"")+"' ind='"+hit_counter+"'>&nbsp;&nbsp;&nbsp;</li>"),hit_counter++):$(this).hide()}),1>=hit_counter&&$(".paragraph_hits").css("visibility","hidden")}$(div).css({position:"absolute",zIndex:1e15,top:$(tr).offset().top+17+"px",left:$(tr).offset().left+"px",width:width+"px",height:"110px"})},this.parse_playlist_results=function(t){if($(".p3_floating_segment").remove(),t.instance_index=parent.instance_index,t.searchterm=parent.searchterm,t.settings=parent.settings,t.load_method=parent.load_method,t.summary.total_entries>0){var e=new EJS({text:parent.files_list,type:"["}).render(t);$(this.container).find(".p3-playlist-results").fadeTo(150,.6,function(){$(this).html(e),$(this).fadeTo(150,1)}),parent.settings.current_page=t.summary.current_page,parent.settings.total_pages=t.summary.total_pages,$(this.container).find(".p3-playlist-progress-summary").html("page "+t.summary.current_page+" of "+t.summary.total_pages)}else{var e=new EJS({text:parent.empty_files_list,type:"["}).render(t);$(this.container).find(".p3-playlist-results").html(e),$(this.container).find(".p3-playlist-progress-summary").html("0 results")}"search"==parent.load_method?parent.instance.event.trigger("Playlist.SearchResult",{searchterm:t.searchterm}):parent.instance.event.trigger("Playlist.AllFiles")},this.segment='<div class="floating_segment_header">    <div class="paragraph_hits">      <ul></ul>    </div>    <span>      <a href="javascript:void(0);" class="p3-playlist-close-segment">&nbsp;</a>    </span>    </div>    <div class="floating_segment_content">    [% for (i=0;i<segments.length;i++) { %]      <p class="segment_content" attr=[%=i%]>        <span class="p3-playlist-play-from" m="[%=segments[i].timestamp%]" video_id="[%=video_id%]">[%=P3.Util.ms_to_stamp(segments[i].timestamp)%]</span>        <span>"... [%= segments[i].content %]..."</span>      </p>    [% } %]    </div>    <div class="p3-floating-segment-point"></div>',this.empty_files_list='<p class="no-results">No results!</p>',this.files_list='<ul class="p3-playlist-ul p3-playlist-ul-[%=load_method.replace("_","-")%]">    [% for (i=0;i<files.length;i++){ %]      <li video_id="[%=files[i].video_id%]">        <a href="javascript:void(0);">          <span class="p3-playlist-play-button">&nbsp;</span>          [% if (settings.show_thumbnails) {%]            <span class="p3-playlist-thumbnail">              <img src="[%=files[i].thumbnail_url%]" onerror="this.src=\'http://p3.3playmedia.com/images/espresso/thumbnail-error.png\'"/>            </span>          [%}%]          <span class="p3-playlist-video-info">            <p class="p3-playlist-video-title">[%=files[i].name%]</p>            <p class="p3-playlist-meta-field-one">[%=P3.Util.ms_to_stamp(files[i].duration)%]</p>          </span>        </a>        [% if (files[i].segmentmap && settings.show_segments) { %]          <div class="p3-playlist-segmentmap-container">            <table class="p3-playlist-segmentmap" cellSpacing="0">              [%= P3.Util.render_segment_map(files[i].segmentmap, {file_id:files[i].id,video_id:files[i].video_id}, "") %]            </table>          </div>          <div class="p3-playlist-search-results-summary">          </div>        [% } %]      </li>    [% } %]  </ul>',this.template='<div class="p3-container p3-playlist-container">    <div class="p3-playlist-topbar">      <form class="p3-playlist-search-form" action="javascript:void(0);">        <input type="button" class="p3-playlist-suggested-results">        <button class="p3-playlist-submit-search"></button>        <input type="text" class="p3-playlist-searchterm" placeholder="[%=search_box_placeholder%]"/>        <div class="p3-playlist-search-reset">&nbsp;</div>      </form>      [% if (typeof suggested_search_terms == "object" && suggested_search_terms.length > 0) { %]        <div class="p3-playlist-suggested-search-terms">          Keywords:&nbsp;          [% for (i=0;i<suggested_search_terms.length;i++){%]            <a href="javascript:void(0);">[%=suggested_search_terms[i]%]</a>          [% } %]        </div>      [% } %]    </div>    <div class="p3-playlist-results"></div>    <div class="p3-playlist-bottombar">      <div class="p3-playlist-video-control">        <span class="p3-playlist-next-video"></span>        <span class="p3-playlist-progress-summary">&nbsp;</span>        <span class="p3-playlist-prev-video"></span>      </div>    </div>  </div>',$(instance).bind("Player.Progress",function(t,e){var i=$(parent.container).find("li[video_id="+e.video_id+"]");return i.hasClass("p3-playlist-currently-playing")?!1:($(parent.container).find("li.p3-playlist-currently-playing").removeClass("p3-playlist-currently-playing"),i.removeClass("p3-playlist-currently-loading"),void i.addClass("p3-playlist-currently-playing"))}),this.init()};